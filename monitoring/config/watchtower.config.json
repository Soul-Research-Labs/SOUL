{
  "node_id": "watchtower-mainnet-1",
  "description": "Primary watchtower node for mainnet monitoring",
  
  "rpc_endpoints": [
    "https://eth-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}",
    "https://arb-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}",
    "https://opt-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}",
    "https://base-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}"
  ],
  
  "chains": [1, 42161, 10, 8453],
  
  "alert_webhook_url": "${ALERT_WEBHOOK_URL}",
  
  "circuit_breaker_address": "0x0000000000000000000000000000000000000000",
  
  "poll_interval": 12,
  "batch_size": 100,
  "confidence_threshold": 0.7,
  "auto_escalate": true,
  "auto_escalate_threshold": 0.9,
  
  "redis_url": "${REDIS_URL}",
  "prometheus_port": 9090,
  
  "monitoring": {
    "log_level": "INFO",
    "log_file": "/var/log/watchtower/watchtower.log",
    "alert_log": "/var/log/watchtower/alerts.jsonl",
    "metrics_retention_hours": 24
  },
  
  "detection_config": {
    "window_size": 1000,
    "enable_statistical": true,
    "enable_pattern": true,
    "enable_bridge": true,
    "z_score_threshold": 3.0,
    "flash_loan_detection": true,
    "sandwich_detection": true,
    "wash_trading_detection": true,
    "sybil_detection": true
  },
  
  "escalation_rules": [
    {
      "anomaly_type": "BRIDGE_EXPLOIT",
      "min_confidence": 0.8,
      "action": "trigger_circuit_breaker"
    },
    {
      "anomaly_type": "FLASH_LOAN_PATTERN",
      "min_confidence": 0.85,
      "action": "alert_only"
    },
    {
      "anomaly_type": "SANDWICH_ATTACK",
      "min_confidence": 0.9,
      "action": "alert_only"
    },
    {
      "risk_level": "CRITICAL",
      "min_confidence": 0.9,
      "action": "trigger_circuit_breaker"
    }
  ],
  
  "protected_contracts": [
    {
      "address": "0x40eaa5de0c6497c8943c967b42799cb092c26adc",
      "name": "CrossChainProofHubV3",
      "chain": 11155111
    },
    {
      "address": "0x52f8a660ff436c450b5190a84bc2c1a86f1032cc",
      "name": "ProofCarryingContainer",
      "chain": 11155111
    },
    {
      "address": "0xf390ae12c9ce8f546ef7c7adaa6a1ab7768a2c78",
      "name": "ZKBoundStateLocks",
      "chain": 11155111
    }
  ],
  
  "health_check": {
    "enabled": true,
    "interval_seconds": 60,
    "endpoint": "/health"
  }
}
