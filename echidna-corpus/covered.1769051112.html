<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Echidna Coverage Report</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
:root {
    --primary: #6366f1;
    --primary-hover: #4f46e5;
    --primary-light: rgba(99,102,241,0.1);
    --success: #22c55e;
    --warning: #eab308;
    --danger: #ef4444;
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --surface: #fff;
    --text: var(--gray-800);
    --text-light: var(--gray-500);
    --radius: 0.375rem;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow: 0 1px 3px rgba(0,0,0,0.1);
    --success-rgb: 34,197,94;
    --warning-rgb: 234,179,8;
    --danger-rgb: 239,68,68;
}

/* Reset */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Roboto', -apple-system, sans-serif;
    font-size: 0.875rem;
    line-height: 1.5;
    color: var(--text);
    background: var(--gray-50);
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

a {
    color: var(--primary);
    text-decoration: none;
}

a:hover {
    color: var(--primary-hover);
    text-decoration: underline;
}

button {
    cursor: pointer;
    background: transparent;
    border: none;
    padding: 0;
    font: inherit;
    color: inherit;
    outline: none;
}

/* Layout */
.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
}

header {
    background: var(--surface);
    border-bottom: 1px solid var(--gray-200);
    padding: 1rem 1.5rem;
    z-index: 10;
    box-shadow: var(--shadow-sm);
}

.header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 1400px;
    margin: 0;
    width: 100%;
}

.logo-text {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--gray-800);
}

/* Buttons */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 2.25rem;
    padding: 0 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: var(--radius);
    transition: all 0.2s;
    border: 1px solid transparent;
}

.btn-secondary {
    background: #B92B3D;
    border-color: #B92B3D;
    color: white;
}

.btn-secondary:hover {
    background: #9e2434;
    border-color: #9e2434;
}

.btn-sm {
    height: 2rem;
    padding: 0 0.5rem;
    font-size: 0.75rem;
}

.button-group {
    display: flex;
    gap: 0.75rem;
    width: 100%;
}

.button-group .btn {
    flex: 1;
}

/* Split panel layout */
.split-panel {
    display: flex;
    flex: 1;
    overflow: hidden;
    position: relative;
}

#file-split-panel {
    display: flex;
    flex-direction: row;
}

/* File explorer panel */
#file-explorer {
    flex: 0 0 260px;
    height: 100%;
    overflow: auto;
    background: var(--surface);
    border-right: 1px solid var(--gray-200);
    padding: 0;
    position: relative;
    min-width: 200px;
    max-width: 500px;
    display: flex;
    flex-direction: column;
    overflow-x: hidden; /* to not show horizontal scrollbar with resizer */
}

#file-explorer-resizer {
    position: absolute;
    top: 0;
    right: -5px;
    width: 10px;
    height: 100%;
    cursor: col-resize;
    z-index: 10;
    background: linear-gradient(to right, transparent, rgba(0,0,0,0.05), transparent);
}

#file-explorer-resizer:hover {
    background: linear-gradient(to right, transparent, rgba(0,0,0,0.1), transparent);
}

.file-explorer-header {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    border-bottom: 1px solid var(--gray-200);
}

.file-search {
    padding: 0.5rem 1rem;
    border-bottom: 1px solid var(--gray-200);
    display: flex;
    align-items: center;
}

.file-search input {
    flex: 1;
    border: 1px solid var(--gray-300);
    border-radius: var(--radius);
    padding: 0.5rem;
    font-size: 0.875rem;
    outline: none;
}

.file-search input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 1px var(--primary-light);
}

#file-search-clear {
    margin-left: 0.5rem;
    color: var(--gray-500);
    font-size: 1.25rem;
    line-height: 1;
    padding: 0.25rem;
    border-radius: var(--radius);
}

#file-search-clear:hover {
    background: var(--gray-100);
}

.search-highlight {
    background: var(--primary-light);
    color: var(--primary);
    font-weight: 500;
}

.search-no-results {
    padding: 1rem;
    font-style: italic;
    color: var(--gray-500);
    text-align: center;
}

.file-explorer-content {
    overflow: auto;
    flex: 1;
    padding: 1rem;
}

.file-explorer-title {
    font-size: 0.875rem;
    font-weight: 600;
    margin: 0;
    color: var(--gray-600);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Main view panel */
#main-view-panel {
    flex: 1;
    height: 100%;
    overflow: auto;
    padding: 1.5rem;
    background: var(--gray-50);
}

/* Stats cards */
.stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.stat-card {
    background: var(--surface);
    border-radius: var(--radius);
    padding: 1.25rem;
    box-shadow: var(--shadow);
    display: flex;
    flex-direction: column;
}

.stat-title {
    font-size: 0.875rem;
    color: var(--text-light);
    margin-bottom: 0.5rem;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.stat-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
    background: var(--primary-light);
    color: var(--primary);
}

/* Progress bar */
.progress-container {
    width: 100%;
    height: 0.5rem;
    background: var(--gray-200);
    border-radius: 9999px;
    overflow: hidden;
    margin-top: 0.5rem;
}

.progress-bar {
    height: 100%;
    border-radius: 9999px;
    transition: width 0.3s;
}

/* File tree */
.file-tree {
    list-style: none;
    padding-left: 0;
    margin: 0;
    font-size: 0.875rem;
}

.file-tree li {
    margin: 0.25rem 0;
}

.file-tree ul {
    list-style: none;
    padding-left: 1.25rem;
    margin: 0.25rem 0;
}

.file-item {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 0.375rem 0.5rem;
    border-radius: var(--radius);
    transition: background-color 0.2s;
}

.file-item:hover {
    background: var(--gray-100);
}

.file-item.active {
    background: var(--primary-light);
    color: var(--primary);
}

.file-toggle {
    width: 1.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    color: var(--gray-500);
}

.file-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 0.5rem;
    color: var(--gray-500);
}

.file-name {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.file-coverage {
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 50%;
    margin-left: 0.5rem;
}

/* File tree icons */
.directory > .file-item > .file-icon:before { content: "ðŸ“"; }
.directory.expanded > .file-item > .file-icon:before { content: "ðŸ“‚"; }
.file > .file-item > .file-icon:before { content: "ðŸ“„"; }
.directory > .file-item > .file-toggle:before { content: "â–¶"; }
.directory.expanded > .file-item > .file-toggle:before { content: "â–¼"; }
.file > .file-item > .file-toggle { visibility: hidden; }
.directory > ul { display: none; }
.directory.expanded > ul { display: block; }

/* Source files */
.source-file {
    margin-bottom: 1.5rem;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    background: var(--surface);
}

.source-file-header {
    padding: 0.75rem 1rem;
    background: #12181E;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: background-color 0.2s;
}

.source-file-header:hover {
    background: #1e2832;
}

.source-file-header .file-info {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.source-file-header .file-name {
    font-weight: 500;
}

.source-file-header .coverage-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
}

.source-file-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.source-file.expanded .source-file-content {
    max-height: none;
}

.source-file-stats {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--gray-200);
    font-size: 0.875rem;
    color: var(--text-light);
}

/* Code styling */
.code-container {
    position: relative;
    overflow: auto;
    max-height: 600px;
}

.code-coverage-table {
    border-collapse: collapse;
    font-family: 'Roboto Mono', monospace;
    font-size: 0.8125rem;
    line-height: 1.5;
    tab-size: 4;
    width: 100%;
}

.code-coverage-table pre {
    margin: 0;
    font-family: inherit;
}

.row-line-number {
    user-select: none;
    text-align: right;
    padding: 0 0.75rem;
    width: 1%;
    min-width: 2.5rem;
    color: var(--gray-400);
    background: var(--gray-100);
    border-right: 1px solid var(--gray-200);
}

.row-reverted-status {
    user-select: none;
    text-align: center;
    width: 1%;
    min-width: 2.25rem;
    max-width: fit-content;
    padding: 0 0.25rem;
    color: var(--gray-600);
    background: var(--gray-100);
    border-right: 1px solid var(--gray-200);
    white-space: nowrap;
}

.row-source {
    padding: 0 0.75rem;
}

.row-line-covered {
    background: rgba(var(--success-rgb), 0.1);
}

.row-line-uncovered {
    background: rgba(var(--danger-rgb), 0.1);
}

/* Footer */
footer {
    background: var(--surface);
    border-top: 1px solid var(--gray-200);
    padding: 1rem;
    text-align: center;
    font-size: 0.875rem;
    color: var(--gray-500);
}

/* Responsive */
@media (max-width: 768px) {
    .stats-container { grid-template-columns: 1fr; }
    #file-explorer { display: none; }
}    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <span class="logo-text">Echidna Coverage Report</span>
            </div>
        </header>

        <!-- Main content -->
        <div class="split-panel" id="file-split-panel">
            <!-- File Explorer -->
            <div id="file-explorer">
                <div class="file-explorer-header">
                    <h3 class="file-explorer-title">Files</h3>
                </div>
                <div class="file-search">
                    <input type="text" id="file-search-input" placeholder="Search files..." />
                    <button id="file-search-clear" title="Clear search">Ã—</button>
                </div>
                <div class="file-explorer-content">
                    <ul id="file-tree-root" class="file-tree"></ul>
                    <div id="search-no-results" class="search-no-results" style="display: none;">No matching files found</div>
                </div>
                <div id="file-explorer-resizer"></div>
            </div>

            <!-- Main panel -->
            <div id="main-view-panel">
                <!-- Overview -->
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-title">Files</div>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Total Lines</div>
                        <div class="stat-value">2657</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Coverage</div>
                        <div class="stat-value">27.0%</div>
                        <div class="progress-container">
                            <div class="progress-bar" style="width: 27.0%; background-color: hsl(32, 90%, 50%)"></div>
                        </div>
                        <div style="margin-top: 0.5rem">
                            <span class="stat-badge">137 / 499 lines</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Actions</div>
                        <div class="button-group">
                            <button class="btn btn-secondary btn-sm" onclick="setAllSourceFilesCollapsed(false)">Expand All</button>
                            <button class="btn btn-secondary btn-sm" onclick="setAllSourceFilesCollapsed(true)">Collapse All</button>
                        </div>
                        <div class="button-group" style="margin-top: 0.5rem">
                            <button class="btn btn-secondary btn-sm" onclick="setEmptySourceFilesCollapsed(false)">Expand Empty</button>
                            <button class="btn btn-secondary btn-sm" onclick="setEmptySourceFilesCollapsed(true)">Collapse Empty</button>
                        </div>
                    </div>
                </div>

                <!-- Individual file coverage -->
                <div class="source-file" id="contracts_pqc_DilithiumVerifier_sol" data-file-path="contracts/pqc/DilithiumVerifier.sol" data-lines-active="76" data-lines-covered="7">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(10, 90%, 50%, 0.15); color: hsl(10, 90%, 50%)">
                                9.0%
                            </span>
                            <span class="file-name">contracts/pqc/DilithiumVerifier.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>7 / 76</strong> (9.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.22;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre> * @title DilithiumVerifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre> * @author PIL Protocol</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @notice On-chain verifier for NIST ML-DSA (Dilithium) post-quantum signatures</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * @dev Implements verification for Dilithium3 and Dilithium5 parameter sets.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> *      This is a placeholder implementation that uses a precompile address.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> *      In production, this would call an EIP-proposed precompile for PQ verification.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * Dilithium Parameters:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * - Dilithium3: 128-bit quantum security, 3.3 KB signatures, 1.9 KB public keys</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * - Dilithium5: 192-bit quantum security, 4.6 KB signatures, 2.6 KB public keys</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>import {Ownable} from &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>contract DilithiumVerifier is Ownable {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    // CONSTANTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    /// @notice Proposed precompile address for Dilithium verification</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    /// @dev This would be assigned by an EIP in the future</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    address public constant DILITHIUM_PRECOMPILE = address(0x0D);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    /// @notice Dilithium3 public key size (bytes)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    uint256 public constant DILITHIUM3_PK_SIZE = 1952;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>    /// @notice Dilithium3 signature size (bytes)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>    uint256 public constant DILITHIUM3_SIG_SIZE = 3293;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>    /// @notice Dilithium5 public key size (bytes)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    uint256 public constant DILITHIUM5_PK_SIZE = 2592;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>    /// @notice Dilithium5 signature size (bytes)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    uint256 public constant DILITHIUM5_SIG_SIZE = 4595;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>    // ENUMS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>    enum DilithiumLevel {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>        Level3, // NIST Security Level 3 (128-bit quantum)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>        Level5 // NIST Security Level 5 (192-bit quantum)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>    // STATE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>    /// @notice Whether to use mock verification (for testing)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>    bool public useMockVerification;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>    /// @notice Mapping of mock verification results for testing</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bool) public mockResults;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>    /// @notice Trusted public key hashes that have been pre-verified</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bool) public trustedKeyHashes;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    /// @notice Gas cost override for verification (0 = use actual)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>    uint256 public gasOverride;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>    // EVENTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>    event DilithiumVerified(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>        bytes32 indexed messageHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>        bytes32 indexed publicKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>        DilithiumLevel level,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>        bool valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>    event TrustedKeyAdded(bytes32 indexed keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>    event TrustedKeyRemoved(bytes32 indexed keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>    event MockModeChanged(bool enabled);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>    // ERRORS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>    error InvalidPublicKeySize(uint256 expected, uint256 actual);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>    error InvalidSignatureSize(uint256 expected, uint256 actual);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>    error PrecompileCallFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>    error InvalidSecurityLevel();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>    // CONSTRUCTOR</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>    constructor() Ownable(msg.sender) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>        useMockVerification = true; // Start in mock mode until precompiles exist</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>    // VERIFICATION FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>     * @notice Verify a Dilithium3 signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>     * @param message The 32-byte message hash that was signed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>     * @param signature The Dilithium3 signature (3293 bytes)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>     * @param publicKey The Dilithium3 public key (1952 bytes)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>     * @return valid True if the signature is valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>    function verifyDilithium3(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>    ) external returns (bool valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>        return _verify(message, signature, publicKey, DilithiumLevel.Level3);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>     * @notice Verify a Dilithium5 signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>     * @param message The 32-byte message hash that was signed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>     * @param signature The Dilithium5 signature (4595 bytes)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>     * @param publicKey The Dilithium5 public key (2592 bytes)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>     * @return valid True if the signature is valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>    function verifyDilithium5(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>    ) external returns (bool valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>        return _verify(message, signature, publicKey, DilithiumLevel.Level5);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>     * @notice Unified verification for any Dilithium level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>     * @param message The message hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>     * @param signature The signature bytes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>     * @param publicKey The public key bytes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>     * @param level The security level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>     * @return valid True if valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>    function verify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>        DilithiumLevel level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre>    ) external returns (bool valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>        return _verify(message, signature, publicKey, level);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>     * @notice Batch verify multiple signatures</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>     * @param messages Array of message hashes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>     * @param signatures Array of signatures</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre>     * @param publicKeys Array of public keys</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>     * @param levels Array of security levels</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>     * @return allValid True if all signatures are valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>    function batchVerify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>        bytes32[] calldata messages,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>        bytes[] calldata signatures,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>        bytes[] calldata publicKeys,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>        DilithiumLevel[] calldata levels</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre>    ) external returns (bool allValid) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>        require(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>            messages.length == signatures.length &amp;&amp;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>                signatures.length == publicKeys.length &amp;&amp;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>                publicKeys.length == levels.length,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>            &quot;Array length mismatch&quot;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>        uint256 len = messages.length;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>        for (uint256 i; i &lt; len; ) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>            if (</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre>                !_verify(messages[i], signatures[i], publicKeys[i], levels[i])</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>            ) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>                return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>            unchecked {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>                ++i;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>    // INTERNAL VERIFICATION</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>    function _verify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>        DilithiumLevel level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>    ) internal returns (bool valid) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre>        // Validate sizes based on level - use inline check for gas efficiency</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>        uint256 pkLen = publicKey.length;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>        uint256 sigLen = signature.length;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre>        if (level == DilithiumLevel.Level3) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>            if (pkLen != DILITHIUM3_PK_SIZE)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>                revert InvalidPublicKeySize(DILITHIUM3_PK_SIZE, pkLen);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>            if (sigLen != DILITHIUM3_SIG_SIZE)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>                revert InvalidSignatureSize(DILITHIUM3_SIG_SIZE, sigLen);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>            if (pkLen != DILITHIUM5_PK_SIZE)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>                revert InvalidPublicKeySize(DILITHIUM5_PK_SIZE, pkLen);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>            if (sigLen != DILITHIUM5_SIG_SIZE)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>                revert InvalidSignatureSize(DILITHIUM5_SIG_SIZE, sigLen);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">209</td>
                                    <td class="row-source"><pre>        bytes32 pkHash = keccak256(publicKey);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">210</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">211</td>
                                    <td class="row-source"><pre>        // Cache storage read for gas efficiency</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">212</td>
                                    <td class="row-source"><pre>        bool mockMode = useMockVerification;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">213</td>
                                    <td class="row-source"><pre>        if (mockMode) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">214</td>
                                    <td class="row-source"><pre>            valid = _mockVerify(message, signature, publicKey, pkHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">215</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">216</td>
                                    <td class="row-source"><pre>            valid = _precompileVerify(message, signature, publicKey, level);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">217</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">218</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">219</td>
                                    <td class="row-source"><pre>        emit DilithiumVerified(message, pkHash, level, valid);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">220</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">221</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">222</td>
                                    <td class="row-source"><pre>    function _mockVerify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">223</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">224</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">225</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">226</td>
                                    <td class="row-source"><pre>        bytes32 pkHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">227</td>
                                    <td class="row-source"><pre>    ) internal view returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">228</td>
                                    <td class="row-source"><pre>        // Check if there&#39;s a preset mock result</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">229</td>
                                    <td class="row-source"><pre>        bytes32 verifyKey = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">230</td>
                                    <td class="row-source"><pre>            abi.encode(message, keccak256(signature), pkHash)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">231</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">232</td>
                                    <td class="row-source"><pre>        if (mockResults[verifyKey]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">233</td>
                                    <td class="row-source"><pre>            return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">234</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">235</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">236</td>
                                    <td class="row-source"><pre>        // Check if public key is in trusted set</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">237</td>
                                    <td class="row-source"><pre>        if (trustedKeyHashes[pkHash]) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">238</td>
                                    <td class="row-source"><pre>            // For trusted keys, perform a simplified check</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">239</td>
                                    <td class="row-source"><pre>            // In reality, this would verify the signature mathematically</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">240</td>
                                    <td class="row-source"><pre>            return signature.length &gt; 0 &amp;&amp; publicKey.length &gt; 0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">241</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">242</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">243</td>
                                    <td class="row-source"><pre>        // Default mock behavior: verify signature format is plausible</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">244</td>
                                    <td class="row-source"><pre>        // First 32 bytes should not be all zeros (basic sanity check)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">245</td>
                                    <td class="row-source"><pre>        bytes32 sigPrefix;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">246</td>
                                    <td class="row-source"><pre>        assembly {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">247</td>
                                    <td class="row-source"><pre>            sigPrefix := calldataload(signature.offset)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">248</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">249</td>
                                    <td class="row-source"><pre>        return sigPrefix != bytes32(0);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">250</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">251</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">252</td>
                                    <td class="row-source"><pre>    function _precompileVerify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">253</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">254</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">255</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">256</td>
                                    <td class="row-source"><pre>        DilithiumLevel level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">257</td>
                                    <td class="row-source"><pre>    ) internal returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">258</td>
                                    <td class="row-source"><pre>        // Encode call data for precompile</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">259</td>
                                    <td class="row-source"><pre>        bytes memory input = abi.encodePacked(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">260</td>
                                    <td class="row-source"><pre>            uint8(level),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">261</td>
                                    <td class="row-source"><pre>            message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">262</td>
                                    <td class="row-source"><pre>            publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">263</td>
                                    <td class="row-source"><pre>            signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">264</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">265</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">266</td>
                                    <td class="row-source"><pre>        uint256 gasToUse = gasOverride &gt; 0 ? gasOverride : gasleft();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">267</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">268</td>
                                    <td class="row-source"><pre>        // Call precompile</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">269</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory result) = DILITHIUM_PRECOMPILE.staticcall{</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">270</td>
                                    <td class="row-source"><pre>            gas: gasToUse</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">271</td>
                                    <td class="row-source"><pre>        }(input);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">272</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">273</td>
                                    <td class="row-source"><pre>        if (!success || result.length == 0) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">274</td>
                                    <td class="row-source"><pre>            // Fallback to mock if precompile not available</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">275</td>
                                    <td class="row-source"><pre>            if (useMockVerification) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">276</td>
                                    <td class="row-source"><pre>                return</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">277</td>
                                    <td class="row-source"><pre>                    _mockVerify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">278</td>
                                    <td class="row-source"><pre>                        message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">279</td>
                                    <td class="row-source"><pre>                        signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">280</td>
                                    <td class="row-source"><pre>                        publicKey,</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">281</td>
                                    <td class="row-source"><pre>                        keccak256(publicKey)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">282</td>
                                    <td class="row-source"><pre>                    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">283</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">284</td>
                                    <td class="row-source"><pre>            revert PrecompileCallFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">285</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">286</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">287</td>
                                    <td class="row-source"><pre>        return abi.decode(result, (bool));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">288</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">289</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">290</td>
                                    <td class="row-source"><pre>    function _getSizes(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">291</td>
                                    <td class="row-source"><pre>        DilithiumLevel level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">292</td>
                                    <td class="row-source"><pre>    ) internal pure returns (uint256 pkSize, uint256 sigSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">293</td>
                                    <td class="row-source"><pre>        if (level == DilithiumLevel.Level3) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">294</td>
                                    <td class="row-source"><pre>            return (DILITHIUM3_PK_SIZE, DILITHIUM3_SIG_SIZE);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">295</td>
                                    <td class="row-source"><pre>        } else if (level == DilithiumLevel.Level5) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">296</td>
                                    <td class="row-source"><pre>            return (DILITHIUM5_PK_SIZE, DILITHIUM5_SIG_SIZE);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">297</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">298</td>
                                    <td class="row-source"><pre>        revert InvalidSecurityLevel();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">299</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">300</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">301</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">302</td>
                                    <td class="row-source"><pre>    // ADMIN FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">303</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">304</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">305</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">306</td>
                                    <td class="row-source"><pre>     * @notice Set mock verification mode</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">307</td>
                                    <td class="row-source"><pre>     * @param enabled True to enable mock mode</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">308</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">309</td>
                                    <td class="row-source"><pre>    function setMockMode(bool enabled) external onlyOwner {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">310</td>
                                    <td class="row-source"><pre>        useMockVerification = enabled;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">311</td>
                                    <td class="row-source"><pre>        emit MockModeChanged(enabled);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">312</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">313</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">314</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">315</td>
                                    <td class="row-source"><pre>     * @notice Add a mock verification result</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">316</td>
                                    <td class="row-source"><pre>     * @param message The message hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">317</td>
                                    <td class="row-source"><pre>     * @param signatureHash Hash of the signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">318</td>
                                    <td class="row-source"><pre>     * @param publicKeyHash Hash of the public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">319</td>
                                    <td class="row-source"><pre>     * @param result The verification result to return</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">320</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">321</td>
                                    <td class="row-source"><pre>    function setMockResult(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">322</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">323</td>
                                    <td class="row-source"><pre>        bytes32 signatureHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">324</td>
                                    <td class="row-source"><pre>        bytes32 publicKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">325</td>
                                    <td class="row-source"><pre>        bool result</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">326</td>
                                    <td class="row-source"><pre>    ) external onlyOwner {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">327</td>
                                    <td class="row-source"><pre>        bytes32 key = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">328</td>
                                    <td class="row-source"><pre>            abi.encode(message, signatureHash, publicKeyHash)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">329</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">330</td>
                                    <td class="row-source"><pre>        mockResults[key] = result;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">331</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">332</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">333</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">334</td>
                                    <td class="row-source"><pre>     * @notice Add a trusted public key hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">335</td>
                                    <td class="row-source"><pre>     * @param keyHash The keccak256 hash of the public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">336</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">337</td>
                                    <td class="row-source"><pre>    function addTrustedKey(bytes32 keyHash) external onlyOwner {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">338</td>
                                    <td class="row-source"><pre>        trustedKeyHashes[keyHash] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">339</td>
                                    <td class="row-source"><pre>        emit TrustedKeyAdded(keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">340</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">341</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">342</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">343</td>
                                    <td class="row-source"><pre>     * @notice Remove a trusted public key hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">344</td>
                                    <td class="row-source"><pre>     * @param keyHash The key hash to remove</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">345</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">346</td>
                                    <td class="row-source"><pre>    function removeTrustedKey(bytes32 keyHash) external onlyOwner {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">347</td>
                                    <td class="row-source"><pre>        trustedKeyHashes[keyHash] = false;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">348</td>
                                    <td class="row-source"><pre>        emit TrustedKeyRemoved(keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">349</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">350</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">351</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">352</td>
                                    <td class="row-source"><pre>     * @notice Set gas override for precompile calls</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">353</td>
                                    <td class="row-source"><pre>     * @param gas Gas amount (0 = use remaining gas)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">354</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">355</td>
                                    <td class="row-source"><pre>    function setGasOverride(uint256 gas) external onlyOwner {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">356</td>
                                    <td class="row-source"><pre>        gasOverride = gas;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">357</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">358</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">359</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">360</td>
                                    <td class="row-source"><pre>    // VIEW FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">361</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">362</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">363</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">364</td>
                                    <td class="row-source"><pre>     * @notice Get expected sizes for a security level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">365</td>
                                    <td class="row-source"><pre>     * @param level The Dilithium level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">366</td>
                                    <td class="row-source"><pre>     * @return pkSize Public key size in bytes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">367</td>
                                    <td class="row-source"><pre>     * @return sigSize Signature size in bytes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">368</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">369</td>
                                    <td class="row-source"><pre>    function getExpectedSizes(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">370</td>
                                    <td class="row-source"><pre>        DilithiumLevel level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">371</td>
                                    <td class="row-source"><pre>    ) external pure returns (uint256 pkSize, uint256 sigSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">372</td>
                                    <td class="row-source"><pre>        return _getSizes(level);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">373</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">374</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">375</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">376</td>
                                    <td class="row-source"><pre>     * @notice Check if a public key is trusted</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">377</td>
                                    <td class="row-source"><pre>     * @param publicKey The public key bytes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">378</td>
                                    <td class="row-source"><pre>     * @return trusted True if the key hash is in the trusted set</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">379</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">380</td>
                                    <td class="row-source"><pre>    function isKeyTrusted(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">381</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">382</td>
                                    <td class="row-source"><pre>    ) external view returns (bool trusted) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">383</td>
                                    <td class="row-source"><pre>        return trustedKeyHashes[keccak256(publicKey)];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">384</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">385</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">386</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">387</td>
                                    <td class="row-source"><pre>     * @notice Estimate gas cost for verification</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">388</td>
                                    <td class="row-source"><pre>     * @param level The security level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">389</td>
                                    <td class="row-source"><pre>     * @return gas Estimated gas cost</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">390</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">391</td>
                                    <td class="row-source"><pre>    function estimateGas(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">392</td>
                                    <td class="row-source"><pre>        DilithiumLevel level</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">393</td>
                                    <td class="row-source"><pre>    ) external pure returns (uint256 gas) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">394</td>
                                    <td class="row-source"><pre>        // Estimated costs (will be defined by EIP)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">395</td>
                                    <td class="row-source"><pre>        if (level == DilithiumLevel.Level3) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">396</td>
                                    <td class="row-source"><pre>            return 150_000;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">397</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">398</td>
                                    <td class="row-source"><pre>            return 200_000;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">399</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">400</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">401</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">402</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="contracts_pqc_KyberKEM_sol" data-file-path="contracts/pqc/KyberKEM.sol" data-lines-active="95" data-lines-covered="27">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(33, 90%, 50%, 0.15); color: hsl(33, 90%, 50%)">
                                28.0%
                            </span>
                            <span class="file-name">contracts/pqc/KyberKEM.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>27 / 95</strong> (28.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.22;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre> * @title KyberKEM</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre> * @author PIL Protocol</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @notice On-chain Key Encapsulation Mechanism using NIST ML-KEM (Kyber)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * @dev Implements Kyber key encapsulation for post-quantum key exchange.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> *      Used for privacy pool key exchanges and cross-chain secure channels.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * Kyber Parameters:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * - Kyber512: 128-bit security, fast</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * - Kyber768: 192-bit security (recommended)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * - Kyber1024: 256-bit security, most secure</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>import {Ownable} from &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>contract KyberKEM is Ownable {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    // CONSTANTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    /// @notice Proposed precompile address for Kyber</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    address public constant KYBER_PRECOMPILE = address(0x0F);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    /// @notice Kyber512 sizes</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER512_PK_SIZE = 800;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER512_SK_SIZE = 1632;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER512_CT_SIZE = 768;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>    /// @notice Kyber768 sizes (recommended)</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER768_PK_SIZE = 1184;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER768_SK_SIZE = 2400;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER768_CT_SIZE = 1088;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>    /// @notice Kyber1024 sizes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER1024_PK_SIZE = 1568;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER1024_SK_SIZE = 3168;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>    uint256 public constant KYBER1024_CT_SIZE = 1568;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>    /// @notice Shared secret size (all variants)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>    uint256 public constant SHARED_SECRET_SIZE = 32;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>    // ENUMS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    enum KyberVariant {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>        Kyber512,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>        Kyber768,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>        Kyber1024</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>    // STRUCTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>     * @notice Encapsulated key material</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    struct Encapsulation {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>        bytes ciphertext; // The encapsulated ciphertext</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>        bytes32 sharedSecretHash; // Hash of the shared secret (for verification)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>        KyberVariant variant; // Which variant was used</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>        uint64 timestamp; // When encapsulation occurred</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>     * @notice Registered public key for an address</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>    struct KyberKeyPair {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>        bytes32 publicKeyHash; // Hash of the full public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>        KyberVariant variant; // Which variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>        uint64 registeredAt; // Registration time</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>        bool isActive; // Whether key is active</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    // STATE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>    /// @notice Mock mode for testing</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>    bool public useMockMode;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>    /// @notice Registered Kyber public keys</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; KyberKeyPair) public registeredKeys;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>    /// @notice Full public keys stored by hash</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bytes) public publicKeyStorage;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>    /// @notice Pending encapsulations awaiting decapsulation</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; Encapsulation) public pendingEncapsulations;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>    /// @notice Completed key exchanges</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bool) public completedExchanges;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>    // EVENTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>    event KeyPairRegistered(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>        address indexed owner,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>        bytes32 indexed publicKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>        KyberVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>    event KeyEncapsulated(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>        bytes32 indexed exchangeId,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>        address indexed sender,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>        address indexed recipient,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>        KyberVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>    event KeyDecapsulated(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>        bytes32 indexed exchangeId,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>        address indexed recipient,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>        bytes32 sharedSecretHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>    event KeyPairRevoked(address indexed owner);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>    // ERRORS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>    error InvalidPublicKeySize(uint256 expected, uint256 actual);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>    error InvalidCiphertextSize(uint256 expected, uint256 actual);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>    error KeyNotRegistered();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>    error KeyAlreadyRegistered();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>    error ExchangeNotFound();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>    error ExchangeAlreadyCompleted();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>    error PrecompileCallFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>    error SharedSecretMismatch();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>    // CONSTRUCTOR</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>    constructor() Ownable(msg.sender) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>        useMockMode = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>    // KEY REGISTRATION</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>     * @notice Register a Kyber public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>     * @param publicKey The full Kyber public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre>     * @param variant The Kyber variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>    function registerPublicKey(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>        KyberVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>    ) external {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>        if (registeredKeys[msg.sender].isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>            revert KeyAlreadyRegistered();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>        uint256 expectedSize = _getPublicKeySize(variant);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>        if (publicKey.length != expectedSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>            revert InvalidPublicKeySize(expectedSize, publicKey.length);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>        bytes32 pkHash = keccak256(publicKey);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>        registeredKeys[msg.sender] = KyberKeyPair({</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>            publicKeyHash: pkHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>            variant: variant,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre>            registeredAt: uint64(block.timestamp),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>            isActive: true</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>        });</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>        // Store full public key</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>        publicKeyStorage[pkHash] = publicKey;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>        emit KeyPairRegistered(msg.sender, pkHash, variant);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>     * @notice Revoke a registered key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>    function revokeKey() external {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre>        if (!registeredKeys[msg.sender].isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>            revert KeyNotRegistered();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>        bytes32 pkHash = registeredKeys[msg.sender].publicKeyHash;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>        delete publicKeyStorage[pkHash];</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>        delete registeredKeys[msg.sender];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>        emit KeyPairRevoked(msg.sender);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>    // KEY ENCAPSULATION</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>     * @notice Encapsulate a shared secret for a recipient</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>     * @param recipient The recipient address</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>     * @param randomness Optional randomness for deterministic encapsulation</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>     * @return exchangeId Unique identifier for this exchange</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>     * @return ciphertext The encapsulated ciphertext to send to recipient</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>     * @return sharedSecretHash Hash of the shared secret (for verification)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">209</td>
                                    <td class="row-source"><pre>    function encapsulate(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">210</td>
                                    <td class="row-source"><pre>        address recipient,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">211</td>
                                    <td class="row-source"><pre>        bytes32 randomness</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">212</td>
                                    <td class="row-source"><pre>    )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">213</td>
                                    <td class="row-source"><pre>        external</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">214</td>
                                    <td class="row-source"><pre>        returns (</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">215</td>
                                    <td class="row-source"><pre>            bytes32 exchangeId,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">216</td>
                                    <td class="row-source"><pre>            bytes memory ciphertext,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">217</td>
                                    <td class="row-source"><pre>            bytes32 sharedSecretHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">218</td>
                                    <td class="row-source"><pre>        )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">219</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">220</td>
                                    <td class="row-source"><pre>        // Cache storage reads for gas efficiency</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">221</td>
                                    <td class="row-source"><pre>        KyberKeyPair memory recipientKey = registeredKeys[recipient];</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">222</td>
                                    <td class="row-source"><pre>        if (!recipientKey.isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">223</td>
                                    <td class="row-source"><pre>            revert KeyNotRegistered();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">224</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">225</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">226</td>
                                    <td class="row-source"><pre>        bytes memory publicKey = publicKeyStorage[recipientKey.publicKeyHash];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">227</td>
                                    <td class="row-source"><pre>        KyberVariant variant = recipientKey.variant;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">228</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">229</td>
                                    <td class="row-source"><pre>        // Generate exchange ID</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">230</td>
                                    <td class="row-source"><pre>        exchangeId = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">231</td>
                                    <td class="row-source"><pre>            abi.encode(msg.sender, recipient, block.timestamp, randomness)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">232</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">233</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">234</td>
                                    <td class="row-source"><pre>        // Cache storage read</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">235</td>
                                    <td class="row-source"><pre>        bool mockMode = useMockMode;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">236</td>
                                    <td class="row-source"><pre>        if (mockMode) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">237</td>
                                    <td class="row-source"><pre>            // Mock encapsulation for testing</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">238</td>
                                    <td class="row-source"><pre>            (ciphertext, sharedSecretHash) = _mockEncapsulate(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">239</td>
                                    <td class="row-source"><pre>                publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">240</td>
                                    <td class="row-source"><pre>                variant,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">241</td>
                                    <td class="row-source"><pre>                randomness</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">242</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">243</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">244</td>
                                    <td class="row-source"><pre>            (ciphertext, sharedSecretHash) = _precompileEncapsulate(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">245</td>
                                    <td class="row-source"><pre>                publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">246</td>
                                    <td class="row-source"><pre>                variant,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">247</td>
                                    <td class="row-source"><pre>                randomness</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">248</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">249</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">250</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">251</td>
                                    <td class="row-source"><pre>        // Store pending encapsulation</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">252</td>
                                    <td class="row-source"><pre>        pendingEncapsulations[exchangeId] = Encapsulation({</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">253</td>
                                    <td class="row-source"><pre>            ciphertext: ciphertext,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">254</td>
                                    <td class="row-source"><pre>            sharedSecretHash: sharedSecretHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">255</td>
                                    <td class="row-source"><pre>            variant: variant,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">256</td>
                                    <td class="row-source"><pre>            timestamp: uint64(block.timestamp)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">257</td>
                                    <td class="row-source"><pre>        });</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">258</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">259</td>
                                    <td class="row-source"><pre>        emit KeyEncapsulated(exchangeId, msg.sender, recipient, variant);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">260</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">261</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">262</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">263</td>
                                    <td class="row-source"><pre>     * @notice Decapsulate a shared secret (off-chain operation, on-chain verification)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">264</td>
                                    <td class="row-source"><pre>     * @param exchangeId The exchange identifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">265</td>
                                    <td class="row-source"><pre>     * @param sharedSecretHash Hash of the decapsulated secret (for verification)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">266</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">267</td>
                                    <td class="row-source"><pre>    function confirmDecapsulation(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">268</td>
                                    <td class="row-source"><pre>        bytes32 exchangeId,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">269</td>
                                    <td class="row-source"><pre>        bytes32 sharedSecretHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">270</td>
                                    <td class="row-source"><pre>    ) external {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">271</td>
                                    <td class="row-source"><pre>        Encapsulation storage encap = pendingEncapsulations[exchangeId];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">272</td>
                                    <td class="row-source"><pre>        if (encap.timestamp == 0) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">273</td>
                                    <td class="row-source"><pre>            revert ExchangeNotFound();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">274</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">275</td>
                                    <td class="row-source"><pre>        if (completedExchanges[exchangeId]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">276</td>
                                    <td class="row-source"><pre>            revert ExchangeAlreadyCompleted();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">277</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">278</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">279</td>
                                    <td class="row-source"><pre>        // Verify the shared secret matches</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">280</td>
                                    <td class="row-source"><pre>        if (encap.sharedSecretHash != sharedSecretHash) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">281</td>
                                    <td class="row-source"><pre>            revert SharedSecretMismatch();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">282</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">283</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">284</td>
                                    <td class="row-source"><pre>        completedExchanges[exchangeId] = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">285</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">286</td>
                                    <td class="row-source"><pre>        emit KeyDecapsulated(exchangeId, msg.sender, sharedSecretHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">287</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">288</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">289</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">290</td>
                                    <td class="row-source"><pre>    // INTERNAL FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">291</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">292</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">293</td>
                                    <td class="row-source"><pre>    function _mockEncapsulate(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">294</td>
                                    <td class="row-source"><pre>        bytes memory publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">295</td>
                                    <td class="row-source"><pre>        KyberVariant variant,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">296</td>
                                    <td class="row-source"><pre>        bytes32 randomness</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">297</td>
                                    <td class="row-source"><pre>    )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">298</td>
                                    <td class="row-source"><pre>        internal</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">299</td>
                                    <td class="row-source"><pre>        view</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">300</td>
                                    <td class="row-source"><pre>        returns (bytes memory ciphertext, bytes32 sharedSecretHash)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">301</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">302</td>
                                    <td class="row-source"><pre>        // Generate deterministic mock ciphertext</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">303</td>
                                    <td class="row-source"><pre>        uint256 ctSize = _getCiphertextSize(variant);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">304</td>
                                    <td class="row-source"><pre>        ciphertext = new bytes(ctSize);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">305</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">306</td>
                                    <td class="row-source"><pre>        // Fill with pseudo-random data</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">307</td>
                                    <td class="row-source"><pre>        bytes32 seed = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">308</td>
                                    <td class="row-source"><pre>            abi.encode(publicKey, randomness, block.timestamp)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">309</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">310</td>
                                    <td class="row-source"><pre>        for (uint256 i = 0; i &lt; ctSize; i += 32) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">311</td>
                                    <td class="row-source"><pre>            seed = keccak256(abi.encode(seed, i));</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">312</td>
                                    <td class="row-source"><pre>            uint256 remaining = ctSize - i;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">313</td>
                                    <td class="row-source"><pre>            uint256 copyLen = remaining &lt; 32 ? remaining : 32;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">314</td>
                                    <td class="row-source"><pre>            for (uint256 j = 0; j &lt; copyLen; j++) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">315</td>
                                    <td class="row-source"><pre>                ciphertext[i + j] = bytes1(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">316</td>
                                    <td class="row-source"><pre>                    uint8(uint256(seed) &gt;&gt; (8 * (31 - j)))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">317</td>
                                    <td class="row-source"><pre>                );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">318</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">319</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">320</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">321</td>
                                    <td class="row-source"><pre>        // Generate mock shared secret hash</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">322</td>
                                    <td class="row-source"><pre>        sharedSecretHash = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">323</td>
                                    <td class="row-source"><pre>            abi.encode(publicKey, ciphertext, randomness)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">324</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">325</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">326</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">327</td>
                                    <td class="row-source"><pre>    function _precompileEncapsulate(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">328</td>
                                    <td class="row-source"><pre>        bytes memory publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">329</td>
                                    <td class="row-source"><pre>        KyberVariant variant,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">330</td>
                                    <td class="row-source"><pre>        bytes32 randomness</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">331</td>
                                    <td class="row-source"><pre>    ) internal returns (bytes memory ciphertext, bytes32 sharedSecretHash) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">332</td>
                                    <td class="row-source"><pre>        bytes memory input = abi.encodePacked(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">333</td>
                                    <td class="row-source"><pre>            uint8(0), // Operation: Encapsulate</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">334</td>
                                    <td class="row-source"><pre>            uint8(variant),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">335</td>
                                    <td class="row-source"><pre>            randomness,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">336</td>
                                    <td class="row-source"><pre>            publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">337</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">338</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">339</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory result) = KYBER_PRECOMPILE.call(input);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">340</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">341</td>
                                    <td class="row-source"><pre>        if (!success || result.length == 0) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">342</td>
                                    <td class="row-source"><pre>            if (useMockMode) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">343</td>
                                    <td class="row-source"><pre>                return _mockEncapsulate(publicKey, variant, randomness);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">344</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">345</td>
                                    <td class="row-source"><pre>            revert PrecompileCallFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">346</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">347</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">348</td>
                                    <td class="row-source"><pre>        // Decode result: ciphertext length (32) + ciphertext + shared secret (32)</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">349</td>
                                    <td class="row-source"><pre>        uint256 ctSize = _getCiphertextSize(variant);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">350</td>
                                    <td class="row-source"><pre>        ciphertext = new bytes(ctSize);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">351</td>
                                    <td class="row-source"><pre>        for (uint256 i; i &lt; ctSize; ) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">352</td>
                                    <td class="row-source"><pre>            ciphertext[i] = result[i];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">353</td>
                                    <td class="row-source"><pre>            unchecked {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">354</td>
                                    <td class="row-source"><pre>                ++i;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">355</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">356</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">357</td>
                                    <td class="row-source"><pre>        // Extract shared secret hash from result</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">358</td>
                                    <td class="row-source"><pre>        assembly {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">359</td>
                                    <td class="row-source"><pre>            sharedSecretHash := mload(add(add(result, 32), ctSize))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">360</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">361</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">362</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">363</td>
                                    <td class="row-source"><pre>    function _getPublicKeySize(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">364</td>
                                    <td class="row-source"><pre>        KyberVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">365</td>
                                    <td class="row-source"><pre>    ) internal pure returns (uint256) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">366</td>
                                    <td class="row-source"><pre>        if (variant == KyberVariant.Kyber512) return KYBER512_PK_SIZE;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">367</td>
                                    <td class="row-source"><pre>        if (variant == KyberVariant.Kyber768) return KYBER768_PK_SIZE;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">368</td>
                                    <td class="row-source"><pre>        return KYBER1024_PK_SIZE;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">369</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">370</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">371</td>
                                    <td class="row-source"><pre>    function _getCiphertextSize(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">372</td>
                                    <td class="row-source"><pre>        KyberVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">373</td>
                                    <td class="row-source"><pre>    ) internal pure returns (uint256) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">374</td>
                                    <td class="row-source"><pre>        if (variant == KyberVariant.Kyber512) return KYBER512_CT_SIZE;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">375</td>
                                    <td class="row-source"><pre>        if (variant == KyberVariant.Kyber768) return KYBER768_CT_SIZE;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">376</td>
                                    <td class="row-source"><pre>        return KYBER1024_CT_SIZE;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">377</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">378</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">379</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">380</td>
                                    <td class="row-source"><pre>    // ADMIN FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">381</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">382</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">383</td>
                                    <td class="row-source"><pre>    function setMockMode(bool enabled) external onlyOwner {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">384</td>
                                    <td class="row-source"><pre>        useMockMode = enabled;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">385</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">386</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">387</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">388</td>
                                    <td class="row-source"><pre>    // VIEW FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">389</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">390</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">391</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">392</td>
                                    <td class="row-source"><pre>     * @notice Get registered key info for an address</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">393</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">394</td>
                                    <td class="row-source"><pre>    function getKeyInfo(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">395</td>
                                    <td class="row-source"><pre>        address owner</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">396</td>
                                    <td class="row-source"><pre>    ) external view returns (KyberKeyPair memory) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">397</td>
                                    <td class="row-source"><pre>        return registeredKeys[owner];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">398</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">399</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">400</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">401</td>
                                    <td class="row-source"><pre>     * @notice Get stored public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">402</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">403</td>
                                    <td class="row-source"><pre>    function getPublicKey(address owner) external view returns (bytes memory) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">404</td>
                                    <td class="row-source"><pre>        bytes32 pkHash = registeredKeys[owner].publicKeyHash;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">405</td>
                                    <td class="row-source"><pre>        return publicKeyStorage[pkHash];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">406</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">407</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">408</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">409</td>
                                    <td class="row-source"><pre>     * @notice Get encapsulation details</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">410</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">411</td>
                                    <td class="row-source"><pre>    function getEncapsulation(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">412</td>
                                    <td class="row-source"><pre>        bytes32 exchangeId</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">413</td>
                                    <td class="row-source"><pre>    ) external view returns (Encapsulation memory) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">414</td>
                                    <td class="row-source"><pre>        return pendingEncapsulations[exchangeId];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">415</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">416</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">417</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">418</td>
                                    <td class="row-source"><pre>     * @notice Check if exchange is completed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">419</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">420</td>
                                    <td class="row-source"><pre>    function isExchangeCompleted(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">421</td>
                                    <td class="row-source"><pre>        bytes32 exchangeId</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">422</td>
                                    <td class="row-source"><pre>    ) external view returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">423</td>
                                    <td class="row-source"><pre>        return completedExchanges[exchangeId];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">424</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">425</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">426</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">427</td>
                                    <td class="row-source"><pre>     * @notice Get expected sizes for a variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">428</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">429</td>
                                    <td class="row-source"><pre>    function getSizes(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">430</td>
                                    <td class="row-source"><pre>        KyberVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">431</td>
                                    <td class="row-source"><pre>    ) external pure returns (uint256 pkSize, uint256 skSize, uint256 ctSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">432</td>
                                    <td class="row-source"><pre>        if (variant == KyberVariant.Kyber512) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">433</td>
                                    <td class="row-source"><pre>            return (KYBER512_PK_SIZE, KYBER512_SK_SIZE, KYBER512_CT_SIZE);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">434</td>
                                    <td class="row-source"><pre>        } else if (variant == KyberVariant.Kyber768) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">435</td>
                                    <td class="row-source"><pre>            return (KYBER768_PK_SIZE, KYBER768_SK_SIZE, KYBER768_CT_SIZE);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">436</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">437</td>
                                    <td class="row-source"><pre>            return (KYBER1024_PK_SIZE, KYBER1024_SK_SIZE, KYBER1024_CT_SIZE);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">438</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">439</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">440</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">441</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="contracts_pqc_PQCRegistry_sol" data-file-path="contracts/pqc/PQCRegistry.sol" data-lines-active="125" data-lines-covered="43">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(40, 90%, 50%, 0.15); color: hsl(40, 90%, 50%)">
                                34.0%
                            </span>
                            <span class="file-name">contracts/pqc/PQCRegistry.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>43 / 125</strong> (34.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.22;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre> * @title PQCRegistry</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre> * @author PIL Protocol</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @notice Central registry for post-quantum cryptography primitives</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * @dev Manages verifiers, KEMs, and hybrid signature schemes for PIL protocol.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> *      Provides a unified interface for post-quantum operations across the protocol.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * SECURITY ARCHITECTURE:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * - Supports NIST PQC standards: Dilithium (ML-DSA), SPHINCS+, Kyber (ML-KEM)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * - Hybrid mode enables graceful transition from classical to post-quantum</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * - Phase-based migration from Optional -&gt; HybridMandatory -&gt; PQCOnly</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> * - All operations are access-controlled via OpenZeppelin&#39;s AccessControl</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>import {AccessControl} from &quot;@openzeppelin/contracts/access/AccessControl.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>import {Pausable} from &quot;@openzeppelin/contracts/utils/Pausable.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>import {DilithiumVerifier} from &quot;./DilithiumVerifier.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>import {SPHINCSPlusVerifier} from &quot;./SPHINCSPlusVerifier.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>import {KyberKEM} from &quot;./KyberKEM.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>contract PQCRegistry is AccessControl, Pausable {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    // CONSTANTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    bytes32 public constant ADMIN_ROLE = keccak256(&quot;ADMIN_ROLE&quot;);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    bytes32 public constant OPERATOR_ROLE = keccak256(&quot;OPERATOR_ROLE&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    // ENUMS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>    enum PQCPrimitive {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>        None,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>        Dilithium3,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>        Dilithium5,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>        SPHINCSPlus128s,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>        SPHINCSPlus128f,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>        SPHINCSPlus256s,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>        SPHINCSPlus256f,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>        Kyber512,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>        Kyber768,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>        Kyber1024</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    enum TransitionPhase {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>        ClassicalOnly, // Only classical crypto used</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>        HybridOptional, // Hybrid available but optional</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>        HybridMandatory, // Hybrid required for new operations</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>        PQPreferred, // PQ preferred, classical still accepted</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>        PQOnly // Only PQ accepted</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>    // STRUCTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>     * @notice Configuration for a registered account</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>     * @dev Packed for gas efficiency - booleans grouped at end</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>    struct AccountPQConfig {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>        bytes32 signatureKeyHash; // Hash of signature public key (slot 1)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>        bytes32 kemKeyHash; // Hash of KEM public key (slot 2)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>        uint64 registeredAt; // Registration timestamp (slot 3 start)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>        PQCPrimitive signatureAlgorithm; // 1 byte</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>        PQCPrimitive kemAlgorithm; // 1 byte</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>        bool hybridEnabled; // 1 byte</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>        bool isActive; // 1 byte - slot 3 = 8+1+1+1+1 = 12 bytes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>     * @notice Statistics for PQC usage</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>    struct PQCStats {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>        uint256 totalAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>        uint256 dilithiumAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>        uint256 sphincsAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>        uint256 kyberAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>        uint256 totalSignatureVerifications;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>        uint256 totalKeyEncapsulations;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>        uint256 hybridVerifications;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>    // STATE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>    /// @notice Dilithium verifier contract</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>    DilithiumVerifier public dilithiumVerifier;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>    /// @notice SPHINCS+ verifier contract</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>    SPHINCSPlusVerifier public sphincsVerifier;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>    /// @notice Kyber KEM contract</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>    KyberKEM public kyberKEM;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>    /// @notice Current transition phase</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>    TransitionPhase public currentPhase;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>    /// @notice Account PQC configurations</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; AccountPQConfig) public accountConfigs;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>    /// @notice Supported primitives</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>    mapping(PQCPrimitive =&gt; bool) public supportedPrimitives;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>    /// @notice Statistics</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>    PQCStats public stats;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>    /// @notice Recommended primitives for new registrations</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>    PQCPrimitive public recommendedSignature;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>    PQCPrimitive public recommendedKEM;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>    // EVENTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>    event VerifierUpdated(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre>        string indexed verifierType,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>        address indexed newAddress</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>    event PhaseTransition(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>        TransitionPhase indexed oldPhase,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>        TransitionPhase indexed newPhase</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>    event AccountConfigured(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>        address indexed account,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>        PQCPrimitive signatureAlg,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>        PQCPrimitive kemAlg</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>    event AccountDeactivated(address indexed account);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>    event PrimitiveStatusChanged(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>        PQCPrimitive indexed primitive,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>        bool supported</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>    event RecommendationUpdated(PQCPrimitive signature, PQCPrimitive kem);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>    // ERRORS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>    error UnsupportedPrimitive(PQCPrimitive primitive);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>    error AccountNotConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>    error AccountAlreadyConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>    error PhaseNotAllowed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>    error VerifierNotSet();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>    error HybridRequired();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>    error InvalidConfiguration();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>    // CONSTRUCTOR</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>    constructor(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>        address _dilithiumVerifier,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>        address _sphincsVerifier,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>        address _kyberKEM</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre>    ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>        _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>        _grantRole(ADMIN_ROLE, msg.sender);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>        if (_dilithiumVerifier != address(0)) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>            dilithiumVerifier = DilithiumVerifier(_dilithiumVerifier);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre>        if (_sphincsVerifier != address(0)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>            sphincsVerifier = SPHINCSPlusVerifier(_sphincsVerifier);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>        if (_kyberKEM != address(0)) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre>            kyberKEM = KyberKEM(_kyberKEM);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>        currentPhase = TransitionPhase.ClassicalOnly;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>        // Enable all primitives by default</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre>        supportedPrimitives[PQCPrimitive.Dilithium3] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>        supportedPrimitives[PQCPrimitive.Dilithium5] = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>        supportedPrimitives[PQCPrimitive.SPHINCSPlus128s] = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>        supportedPrimitives[PQCPrimitive.SPHINCSPlus256s] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre>        supportedPrimitives[PQCPrimitive.Kyber768] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>        supportedPrimitives[PQCPrimitive.Kyber1024] = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>        // Set recommended defaults</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre>        recommendedSignature = PQCPrimitive.Dilithium3;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>        recommendedKEM = PQCPrimitive.Kyber768;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>    // ACCOUNT CONFIGURATION</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>     * @notice Configure PQC settings for an account</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre>     * @param signatureAlgorithm Signature algorithm to use</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre>     * @param kemAlgorithm KEM algorithm to use</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>     * @param signatureKeyHash Hash of signature public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>     * @param kemKeyHash Hash of KEM public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>     * @param enableHybrid Whether to enable hybrid mode</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>    function configureAccount(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>        PQCPrimitive signatureAlgorithm,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>        PQCPrimitive kemAlgorithm,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>        bytes32 signatureKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>        bytes32 kemKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>        bool enableHybrid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre>    ) external whenNotPaused {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">209</td>
                                    <td class="row-source"><pre>        if (accountConfigs[msg.sender].isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">210</td>
                                    <td class="row-source"><pre>            revert AccountAlreadyConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">211</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">212</td>
                                    <td class="row-source"><pre>        if (!supportedPrimitives[signatureAlgorithm]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">213</td>
                                    <td class="row-source"><pre>            revert UnsupportedPrimitive(signatureAlgorithm);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">214</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">215</td>
                                    <td class="row-source"><pre>        if (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">216</td>
                                    <td class="row-source"><pre>            kemAlgorithm != PQCPrimitive.None &amp;&amp;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">217</td>
                                    <td class="row-source"><pre>            !supportedPrimitives[kemAlgorithm]</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">218</td>
                                    <td class="row-source"><pre>        ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">219</td>
                                    <td class="row-source"><pre>            revert UnsupportedPrimitive(kemAlgorithm);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">220</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">221</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">222</td>
                                    <td class="row-source"><pre>        // Validate phase requirements</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">223</td>
                                    <td class="row-source"><pre>        if (currentPhase == TransitionPhase.HybridMandatory &amp;&amp; !enableHybrid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">224</td>
                                    <td class="row-source"><pre>            revert HybridRequired();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">225</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">226</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">227</td>
                                    <td class="row-source"><pre>        accountConfigs[msg.sender] = AccountPQConfig({</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">228</td>
                                    <td class="row-source"><pre>            signatureAlgorithm: signatureAlgorithm,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">229</td>
                                    <td class="row-source"><pre>            kemAlgorithm: kemAlgorithm,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">230</td>
                                    <td class="row-source"><pre>            signatureKeyHash: signatureKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">231</td>
                                    <td class="row-source"><pre>            kemKeyHash: kemKeyHash,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">232</td>
                                    <td class="row-source"><pre>            registeredAt: uint64(block.timestamp),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">233</td>
                                    <td class="row-source"><pre>            hybridEnabled: enableHybrid,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">234</td>
                                    <td class="row-source"><pre>            isActive: true</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">235</td>
                                    <td class="row-source"><pre>        });</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">236</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">237</td>
                                    <td class="row-source"><pre>        // Update statistics with unchecked for gas savings</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">238</td>
                                    <td class="row-source"><pre>        unchecked {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">239</td>
                                    <td class="row-source"><pre>            ++stats.totalAccounts;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">240</td>
                                    <td class="row-source"><pre>            if (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">241</td>
                                    <td class="row-source"><pre>                signatureAlgorithm == PQCPrimitive.Dilithium3 ||</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">242</td>
                                    <td class="row-source"><pre>                signatureAlgorithm == PQCPrimitive.Dilithium5</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">243</td>
                                    <td class="row-source"><pre>            ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">244</td>
                                    <td class="row-source"><pre>                ++stats.dilithiumAccounts;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">245</td>
                                    <td class="row-source"><pre>            } else if (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">246</td>
                                    <td class="row-source"><pre>                uint8(signatureAlgorithm) &gt;= 3 &amp;&amp; uint8(signatureAlgorithm) &lt;= 6</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">247</td>
                                    <td class="row-source"><pre>            ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">248</td>
                                    <td class="row-source"><pre>                ++stats.sphincsAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">249</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">250</td>
                                    <td class="row-source"><pre>            if (kemAlgorithm != PQCPrimitive.None) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">251</td>
                                    <td class="row-source"><pre>                ++stats.kyberAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">252</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">253</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">254</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">255</td>
                                    <td class="row-source"><pre>        emit AccountConfigured(msg.sender, signatureAlgorithm, kemAlgorithm);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">256</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">257</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">258</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">259</td>
                                    <td class="row-source"><pre>     * @notice Update account configuration</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">260</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">261</td>
                                    <td class="row-source"><pre>    function updateAccount(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">262</td>
                                    <td class="row-source"><pre>        PQCPrimitive signatureAlgorithm,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">263</td>
                                    <td class="row-source"><pre>        PQCPrimitive kemAlgorithm,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">264</td>
                                    <td class="row-source"><pre>        bytes32 signatureKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">265</td>
                                    <td class="row-source"><pre>        bytes32 kemKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">266</td>
                                    <td class="row-source"><pre>        bool enableHybrid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">267</td>
                                    <td class="row-source"><pre>    ) external whenNotPaused {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">268</td>
                                    <td class="row-source"><pre>        if (!accountConfigs[msg.sender].isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">269</td>
                                    <td class="row-source"><pre>            revert AccountNotConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">270</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">271</td>
                                    <td class="row-source"><pre>        if (!supportedPrimitives[signatureAlgorithm]) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">272</td>
                                    <td class="row-source"><pre>            revert UnsupportedPrimitive(signatureAlgorithm);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">273</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">274</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">275</td>
                                    <td class="row-source"><pre>        AccountPQConfig storage config = accountConfigs[msg.sender];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">276</td>
                                    <td class="row-source"><pre>        config.signatureAlgorithm = signatureAlgorithm;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">277</td>
                                    <td class="row-source"><pre>        config.kemAlgorithm = kemAlgorithm;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">278</td>
                                    <td class="row-source"><pre>        config.signatureKeyHash = signatureKeyHash;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">279</td>
                                    <td class="row-source"><pre>        config.kemKeyHash = kemKeyHash;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">280</td>
                                    <td class="row-source"><pre>        config.hybridEnabled = enableHybrid;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">281</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">282</td>
                                    <td class="row-source"><pre>        emit AccountConfigured(msg.sender, signatureAlgorithm, kemAlgorithm);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">283</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">284</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">285</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">286</td>
                                    <td class="row-source"><pre>     * @notice Deactivate account PQC configuration</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">287</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">288</td>
                                    <td class="row-source"><pre>    function deactivateAccount() external {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">289</td>
                                    <td class="row-source"><pre>        if (!accountConfigs[msg.sender].isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">290</td>
                                    <td class="row-source"><pre>            revert AccountNotConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">291</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">292</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">293</td>
                                    <td class="row-source"><pre>        accountConfigs[msg.sender].isActive = false;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">294</td>
                                    <td class="row-source"><pre>        stats.totalAccounts--;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">295</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">296</td>
                                    <td class="row-source"><pre>        emit AccountDeactivated(msg.sender);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">297</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">298</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">299</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">300</td>
                                    <td class="row-source"><pre>    // SIGNATURE VERIFICATION</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">301</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">302</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">303</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">304</td>
                                    <td class="row-source"><pre>     * @notice Verify a post-quantum signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">305</td>
                                    <td class="row-source"><pre>     * @param signer The claimed signer address</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">306</td>
                                    <td class="row-source"><pre>     * @param message The message hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">307</td>
                                    <td class="row-source"><pre>     * @param signature The PQ signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">308</td>
                                    <td class="row-source"><pre>     * @param publicKey The PQ public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">309</td>
                                    <td class="row-source"><pre>     * @return valid True if signature is valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">310</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">311</td>
                                    <td class="row-source"><pre>    function verifySignature(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">312</td>
                                    <td class="row-source"><pre>        address signer,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">313</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">314</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">315</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">316</td>
                                    <td class="row-source"><pre>    ) external returns (bool valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">317</td>
                                    <td class="row-source"><pre>        AccountPQConfig storage config = accountConfigs[signer];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">318</td>
                                    <td class="row-source"><pre>        if (!config.isActive) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">319</td>
                                    <td class="row-source"><pre>            // If not configured, check phase</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">320</td>
                                    <td class="row-source"><pre>            if (currentPhase &gt;= TransitionPhase.PQPreferred) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">321</td>
                                    <td class="row-source"><pre>                revert AccountNotConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">322</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">323</td>
                                    <td class="row-source"><pre>            return false; // Classical-only account</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">324</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">325</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">326</td>
                                    <td class="row-source"><pre>        // Verify public key matches registered hash</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">327</td>
                                    <td class="row-source"><pre>        if (keccak256(publicKey) != config.signatureKeyHash) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">328</td>
                                    <td class="row-source"><pre>            return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">329</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">330</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">331</td>
                                    <td class="row-source"><pre>        PQCPrimitive alg = config.signatureAlgorithm;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">332</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">333</td>
                                    <td class="row-source"><pre>        if (alg == PQCPrimitive.Dilithium3) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">334</td>
                                    <td class="row-source"><pre>            if (address(dilithiumVerifier) == address(0))</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">335</td>
                                    <td class="row-source"><pre>                revert VerifierNotSet();</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">336</td>
                                    <td class="row-source"><pre>            valid = dilithiumVerifier.verifyDilithium3(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">337</td>
                                    <td class="row-source"><pre>                message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">338</td>
                                    <td class="row-source"><pre>                signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">339</td>
                                    <td class="row-source"><pre>                publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">340</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">341</td>
                                    <td class="row-source"><pre>        } else if (alg == PQCPrimitive.Dilithium5) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">342</td>
                                    <td class="row-source"><pre>            if (address(dilithiumVerifier) == address(0))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">343</td>
                                    <td class="row-source"><pre>                revert VerifierNotSet();</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">344</td>
                                    <td class="row-source"><pre>            valid = dilithiumVerifier.verifyDilithium5(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">345</td>
                                    <td class="row-source"><pre>                message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">346</td>
                                    <td class="row-source"><pre>                signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">347</td>
                                    <td class="row-source"><pre>                publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">348</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">349</td>
                                    <td class="row-source"><pre>        } else if (alg == PQCPrimitive.SPHINCSPlus128s) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">350</td>
                                    <td class="row-source"><pre>            if (address(sphincsVerifier) == address(0)) revert VerifierNotSet();</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">351</td>
                                    <td class="row-source"><pre>            valid = sphincsVerifier.verifySPHINCS128s(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">352</td>
                                    <td class="row-source"><pre>                message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">353</td>
                                    <td class="row-source"><pre>                signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">354</td>
                                    <td class="row-source"><pre>                publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">355</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">356</td>
                                    <td class="row-source"><pre>        } else if (alg == PQCPrimitive.SPHINCSPlus256s) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">357</td>
                                    <td class="row-source"><pre>            if (address(sphincsVerifier) == address(0)) revert VerifierNotSet();</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">358</td>
                                    <td class="row-source"><pre>            valid = sphincsVerifier.verifySPHINCS256s(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">359</td>
                                    <td class="row-source"><pre>                message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">360</td>
                                    <td class="row-source"><pre>                signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">361</td>
                                    <td class="row-source"><pre>                publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">362</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">363</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">364</td>
                                    <td class="row-source"><pre>            revert UnsupportedPrimitive(alg);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">365</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">366</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">367</td>
                                    <td class="row-source"><pre>        if (valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">368</td>
                                    <td class="row-source"><pre>            stats.totalSignatureVerifications++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">369</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">370</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">371</td>
                                    <td class="row-source"><pre>        return valid;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">372</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">373</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">374</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">375</td>
                                    <td class="row-source"><pre>     * @notice Verify a hybrid signature (classical + PQ)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">376</td>
                                    <td class="row-source"><pre>     * @param signer The signer address</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">377</td>
                                    <td class="row-source"><pre>     * @param message The message hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">378</td>
                                    <td class="row-source"><pre>     * @param classicalSig ECDSA signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">379</td>
                                    <td class="row-source"><pre>     * @param pqSignature PQ signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">380</td>
                                    <td class="row-source"><pre>     * @param pqPublicKey PQ public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">381</td>
                                    <td class="row-source"><pre>     * @return valid True if both signatures are valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">382</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">383</td>
                                    <td class="row-source"><pre>    function verifyHybridSignature(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">384</td>
                                    <td class="row-source"><pre>        address signer,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">385</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">386</td>
                                    <td class="row-source"><pre>        bytes calldata classicalSig,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">387</td>
                                    <td class="row-source"><pre>        bytes calldata pqSignature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">388</td>
                                    <td class="row-source"><pre>        bytes calldata pqPublicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">389</td>
                                    <td class="row-source"><pre>    ) external returns (bool valid) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">390</td>
                                    <td class="row-source"><pre>        // Verify classical ECDSA</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">391</td>
                                    <td class="row-source"><pre>        bytes32 ethHash = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">392</td>
                                    <td class="row-source"><pre>            abi.encodePacked(&quot;\x19Ethereum Signed Message:\n32&quot;, message)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">393</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">394</td>
                                    <td class="row-source"><pre>        address recovered = _recoverSigner(ethHash, classicalSig);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">395</td>
                                    <td class="row-source"><pre>        if (recovered != signer) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">396</td>
                                    <td class="row-source"><pre>            return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">397</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">398</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">399</td>
                                    <td class="row-source"><pre>        // Verify PQ signature</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">400</td>
                                    <td class="row-source"><pre>        valid = this.verifySignature(signer, message, pqSignature, pqPublicKey);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">401</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">402</td>
                                    <td class="row-source"><pre>        if (valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">403</td>
                                    <td class="row-source"><pre>            stats.hybridVerifications++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">404</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">405</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">406</td>
                                    <td class="row-source"><pre>        return valid;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">407</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">408</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">409</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">410</td>
                                    <td class="row-source"><pre>    // KEY ENCAPSULATION</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">411</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">412</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">413</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">414</td>
                                    <td class="row-source"><pre>     * @notice Initiate key exchange with a recipient</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">415</td>
                                    <td class="row-source"><pre>     * @param recipient The recipient address</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">416</td>
                                    <td class="row-source"><pre>     * @return exchangeId The exchange identifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">417</td>
                                    <td class="row-source"><pre>     * @return ciphertext The encapsulated ciphertext</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">418</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">419</td>
                                    <td class="row-source"><pre>    function initiateKeyExchange(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">420</td>
                                    <td class="row-source"><pre>        address recipient</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">421</td>
                                    <td class="row-source"><pre>    )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">422</td>
                                    <td class="row-source"><pre>        external</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">423</td>
                                    <td class="row-source"><pre>        whenNotPaused</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">424</td>
                                    <td class="row-source"><pre>        returns (bytes32 exchangeId, bytes memory ciphertext)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">425</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">426</td>
                                    <td class="row-source"><pre>        if (address(kyberKEM) == address(0)) revert VerifierNotSet();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">427</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">428</td>
                                    <td class="row-source"><pre>        AccountPQConfig storage recipientConfig = accountConfigs[recipient];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">429</td>
                                    <td class="row-source"><pre>        if (</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">430</td>
                                    <td class="row-source"><pre>            !recipientConfig.isActive ||</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">431</td>
                                    <td class="row-source"><pre>            recipientConfig.kemAlgorithm == PQCPrimitive.None</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">432</td>
                                    <td class="row-source"><pre>        ) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">433</td>
                                    <td class="row-source"><pre>            revert AccountNotConfigured();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">434</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">435</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">436</td>
                                    <td class="row-source"><pre>        bytes32 sharedSecretHash;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">437</td>
                                    <td class="row-source"><pre>        (exchangeId, ciphertext, sharedSecretHash) = kyberKEM.encapsulate(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">438</td>
                                    <td class="row-source"><pre>            recipient,</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">439</td>
                                    <td class="row-source"><pre>            keccak256(abi.encode(msg.sender, block.timestamp, block.prevrandao))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">440</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">441</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">442</td>
                                    <td class="row-source"><pre>        stats.totalKeyEncapsulations++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">443</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">444</td>
                                    <td class="row-source"><pre>        return (exchangeId, ciphertext);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">445</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">446</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">447</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">448</td>
                                    <td class="row-source"><pre>    // ADMIN FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">449</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">450</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">451</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">452</td>
                                    <td class="row-source"><pre>     * @notice Update verifier contracts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">453</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">454</td>
                                    <td class="row-source"><pre>    function setDilithiumVerifier(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">455</td>
                                    <td class="row-source"><pre>        address _verifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">456</td>
                                    <td class="row-source"><pre>    ) external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">457</td>
                                    <td class="row-source"><pre>        dilithiumVerifier = DilithiumVerifier(_verifier);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">458</td>
                                    <td class="row-source"><pre>        emit VerifierUpdated(&quot;Dilithium&quot;, _verifier);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">459</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">460</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">461</td>
                                    <td class="row-source"><pre>    function setSPHINCSVerifier(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">462</td>
                                    <td class="row-source"><pre>        address _verifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">463</td>
                                    <td class="row-source"><pre>    ) external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">464</td>
                                    <td class="row-source"><pre>        sphincsVerifier = SPHINCSPlusVerifier(_verifier);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">465</td>
                                    <td class="row-source"><pre>        emit VerifierUpdated(&quot;SPHINCS&quot;, _verifier);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">466</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">467</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">468</td>
                                    <td class="row-source"><pre>    function setKyberKEM(address _kem) external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">469</td>
                                    <td class="row-source"><pre>        kyberKEM = KyberKEM(_kem);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">470</td>
                                    <td class="row-source"><pre>        emit VerifierUpdated(&quot;Kyber&quot;, _kem);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">471</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">472</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">473</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">474</td>
                                    <td class="row-source"><pre>     * @notice Transition to a new phase</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">475</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">476</td>
                                    <td class="row-source"><pre>    function transitionPhase(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">477</td>
                                    <td class="row-source"><pre>        TransitionPhase newPhase</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">478</td>
                                    <td class="row-source"><pre>    ) external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">479</td>
                                    <td class="row-source"><pre>        require(uint8(newPhase) &gt;= uint8(currentPhase), &quot;Cannot go backwards&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">480</td>
                                    <td class="row-source"><pre>        TransitionPhase oldPhase = currentPhase;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">481</td>
                                    <td class="row-source"><pre>        currentPhase = newPhase;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">482</td>
                                    <td class="row-source"><pre>        emit PhaseTransition(oldPhase, newPhase);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">483</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">484</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">485</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">486</td>
                                    <td class="row-source"><pre>     * @notice Enable/disable a primitive</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">487</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">488</td>
                                    <td class="row-source"><pre>    function setPrimitiveSupport(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">489</td>
                                    <td class="row-source"><pre>        PQCPrimitive primitive,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">490</td>
                                    <td class="row-source"><pre>        bool supported</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">491</td>
                                    <td class="row-source"><pre>    ) external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">492</td>
                                    <td class="row-source"><pre>        supportedPrimitives[primitive] = supported;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">493</td>
                                    <td class="row-source"><pre>        emit PrimitiveStatusChanged(primitive, supported);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">494</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">495</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">496</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">497</td>
                                    <td class="row-source"><pre>     * @notice Update recommended primitives</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">498</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">499</td>
                                    <td class="row-source"><pre>    function setRecommendations(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">500</td>
                                    <td class="row-source"><pre>        PQCPrimitive signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">501</td>
                                    <td class="row-source"><pre>        PQCPrimitive kem</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">502</td>
                                    <td class="row-source"><pre>    ) external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">503</td>
                                    <td class="row-source"><pre>        recommendedSignature = signature;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">504</td>
                                    <td class="row-source"><pre>        recommendedKEM = kem;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">505</td>
                                    <td class="row-source"><pre>        emit RecommendationUpdated(signature, kem);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">506</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">507</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">508</td>
                                    <td class="row-source"><pre>    function pause() external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">509</td>
                                    <td class="row-source"><pre>        _pause();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">510</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">511</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">512</td>
                                    <td class="row-source"><pre>    function unpause() external onlyRole(ADMIN_ROLE) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">513</td>
                                    <td class="row-source"><pre>        _unpause();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">514</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">515</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">516</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">517</td>
                                    <td class="row-source"><pre>    // VIEW FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">518</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">519</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">520</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">521</td>
                                    <td class="row-source"><pre>     * @notice Get account configuration</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">522</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">523</td>
                                    <td class="row-source"><pre>    function getAccountConfig(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">524</td>
                                    <td class="row-source"><pre>        address account</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">525</td>
                                    <td class="row-source"><pre>    ) external view returns (AccountPQConfig memory) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">526</td>
                                    <td class="row-source"><pre>        return accountConfigs[account];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">527</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">528</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">529</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">530</td>
                                    <td class="row-source"><pre>     * @notice Check if account has PQC configured</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">531</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">532</td>
                                    <td class="row-source"><pre>    function isPQCEnabled(address account) external view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">533</td>
                                    <td class="row-source"><pre>        return accountConfigs[account].isActive;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">534</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">535</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">536</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">537</td>
                                    <td class="row-source"><pre>     * @notice Get current statistics</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">538</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">539</td>
                                    <td class="row-source"><pre>    function getStats() external view returns (PQCStats memory) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">540</td>
                                    <td class="row-source"><pre>        return stats;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">541</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">542</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">543</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">544</td>
                                    <td class="row-source"><pre>     * @notice Get recommended configuration</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">545</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">546</td>
                                    <td class="row-source"><pre>    function getRecommendedConfig()</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">547</td>
                                    <td class="row-source"><pre>        external</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">548</td>
                                    <td class="row-source"><pre>        view</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">549</td>
                                    <td class="row-source"><pre>        returns (PQCPrimitive signature, PQCPrimitive kem, bool hybridEnabled)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">550</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">551</td>
                                    <td class="row-source"><pre>        return (</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">552</td>
                                    <td class="row-source"><pre>            recommendedSignature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">553</td>
                                    <td class="row-source"><pre>            recommendedKEM,</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">554</td>
                                    <td class="row-source"><pre>            currentPhase &gt;= TransitionPhase.HybridOptional</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">555</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">556</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">557</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">558</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">559</td>
                                    <td class="row-source"><pre>     * @notice Check if phase allows classical-only</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">560</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">561</td>
                                    <td class="row-source"><pre>    function allowsClassicalOnly() external view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">562</td>
                                    <td class="row-source"><pre>        return currentPhase &lt;= TransitionPhase.HybridOptional;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">563</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">564</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">565</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">566</td>
                                    <td class="row-source"><pre>    // INTERNAL FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">567</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">568</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">569</td>
                                    <td class="row-source"><pre>    function _recoverSigner(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">570</td>
                                    <td class="row-source"><pre>        bytes32 hash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">571</td>
                                    <td class="row-source"><pre>        bytes calldata signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">572</td>
                                    <td class="row-source"><pre>    ) internal pure returns (address) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">573</td>
                                    <td class="row-source"><pre>        require(signature.length == 65, &quot;Invalid signature length&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">574</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">575</td>
                                    <td class="row-source"><pre>        bytes32 r;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">576</td>
                                    <td class="row-source"><pre>        bytes32 s;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">577</td>
                                    <td class="row-source"><pre>        uint8 v;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">578</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">579</td>
                                    <td class="row-source"><pre>        assembly {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">580</td>
                                    <td class="row-source"><pre>            r := calldataload(signature.offset)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">581</td>
                                    <td class="row-source"><pre>            s := calldataload(add(signature.offset, 32))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">582</td>
                                    <td class="row-source"><pre>            v := byte(0, calldataload(add(signature.offset, 64)))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">583</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">584</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">585</td>
                                    <td class="row-source"><pre>        if (v &lt; 27) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">586</td>
                                    <td class="row-source"><pre>            v += 27;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">587</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">588</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">589</td>
                                    <td class="row-source"><pre>        return ecrecover(hash, v, r, s);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">590</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">591</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">592</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="contracts_pqc_SPHINCSPlusVerifier_sol" data-file-path="contracts/pqc/SPHINCSPlusVerifier.sol" data-lines-active="66" data-lines-covered="0">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(0, 90%, 50%, 0.15); color: hsl(0, 90%, 50%)">
                                0.0%
                            </span>
                            <span class="file-name">contracts/pqc/SPHINCSPlusVerifier.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>0 / 66</strong> (0.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.22;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre> * @title SPHINCSPlusVerifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre> * @author PIL Protocol</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @notice On-chain verifier for SPHINCS+ (SLH-DSA) post-quantum signatures</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * @dev Implements verification for SPHINCS+ hash-based signatures.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> *      SPHINCS+ is stateless and based only on hash functions, making it</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> *      the most conservative post-quantum choice with no lattice assumptions.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * SPHINCS+ Parameters:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * - SPHINCS+-128s: 128-bit security, 7.9 KB signatures (small)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * - SPHINCS+-128f: 128-bit security, 17 KB signatures (fast)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> * - SPHINCS+-256s: 256-bit security, 29 KB signatures (small)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> * - SPHINCS+-256f: 256-bit security, 49 KB signatures (fast)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>import {Ownable} from &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>contract SPHINCSPlusVerifier is Ownable {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    // CONSTANTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    /// @notice Proposed precompile address for SPHINCS+ verification</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    address public constant SPHINCS_PRECOMPILE = address(0x0E);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    /// @notice Parameter set sizes</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    uint256 public constant SPHINCS_128S_PK_SIZE = 32;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>    uint256 public constant SPHINCS_128S_SIG_SIZE = 7856;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>    uint256 public constant SPHINCS_128F_SIG_SIZE = 17088;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    uint256 public constant SPHINCS_256S_PK_SIZE = 64;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>    uint256 public constant SPHINCS_256S_SIG_SIZE = 29792;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    uint256 public constant SPHINCS_256F_SIG_SIZE = 49856;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    // ENUMS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>    enum SPHINCSVariant {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>        SPHINCS_128s, // Small, 128-bit security</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>        SPHINCS_128f, // Fast, 128-bit security</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>        SPHINCS_256s, // Small, 256-bit security</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>        SPHINCS_256f // Fast, 256-bit security</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    // STATE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>    /// @notice Whether to use mock verification</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>    bool public useMockVerification;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>    /// @notice Trusted key hashes</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bool) public trustedKeyHashes;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>    /// @notice Pre-verified signatures for testing</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bool) public preVerified;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    // EVENTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>    event SPHINCSVerified(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>        bytes32 indexed messageHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>        bytes32 indexed publicKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>        SPHINCSVariant variant,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>        bool valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>    );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>    event TrustedKeyAdded(bytes32 indexed keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>    event TrustedKeyRemoved(bytes32 indexed keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>    // ERRORS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>    error InvalidPublicKeySize(uint256 expected, uint256 actual);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    error InvalidSignatureSize(uint256 minExpected, uint256 actual);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>    error PrecompileCallFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>    error UnsupportedVariant();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>    // CONSTRUCTOR</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>    constructor() Ownable(msg.sender) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>        useMockVerification = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>    // VERIFICATION FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>     * @notice Verify a SPHINCS+ signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>     * @param message The 32-byte message hash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>     * @param signature The SPHINCS+ signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre>     * @param publicKey The SPHINCS+ public key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>     * @param variant The parameter set variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>     * @return valid True if signature is valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>    function verify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>        SPHINCSVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>    ) external returns (bool valid) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>        // Validate sizes</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>        (uint256 expectedPkSize, uint256 minSigSize) = _getSizes(variant);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>        if (publicKey.length != expectedPkSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>            revert InvalidPublicKeySize(expectedPkSize, publicKey.length);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>        if (signature.length &lt; minSigSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>            revert InvalidSignatureSize(minSigSize, signature.length);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>        bytes32 pkHash = keccak256(publicKey);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>        bytes32 sigHash = keccak256(signature);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>        // Check pre-verified cache</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>        bytes32 cacheKey = keccak256(abi.encode(message, sigHash, pkHash));</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>        if (preVerified[cacheKey]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>            emit SPHINCSVerified(message, pkHash, variant, true);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>            return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>        if (useMockVerification) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>            valid = _mockVerify(message, publicKey, pkHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>            valid = _precompileVerify(message, signature, publicKey, variant);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>        // Cache successful verifications</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>        if (valid) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>            preVerified[cacheKey] = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>        emit SPHINCSVerified(message, pkHash, variant, valid);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>        return valid;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>     * @notice Verify SPHINCS+-128s signature (most common variant)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>    function verifySPHINCS128s(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre>    ) external returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>        return</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>            this.verify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>                message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>                signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>                publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>                SPHINCSVariant.SPHINCS_128s</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>     * @notice Verify SPHINCS+-256s signature (maximum security)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>    function verifySPHINCS256s(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>    ) external returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>        return</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>            this.verify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre>                message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>                signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>                publicKey,</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>                SPHINCSVariant.SPHINCS_256s</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>    // INTERNAL</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>    function _mockVerify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre>        bytes32 pkHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>    ) internal view returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>        // Trust pre-registered keys</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre>        if (trustedKeyHashes[pkHash]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>            return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre>        // Basic sanity checks for mock mode</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>        // Real implementation would verify the Merkle tree structure</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>        return message != bytes32(0) &amp;&amp; publicKey.length &gt; 0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>    function _precompileVerify(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>        bytes calldata signature,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>        SPHINCSVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>    ) internal returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>        bytes memory input = abi.encodePacked(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>            uint8(variant),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>            message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>            publicKey,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre>            signature</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">209</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">210</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">211</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory result) = SPHINCS_PRECOMPILE.staticcall(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">212</td>
                                    <td class="row-source"><pre>            input</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">213</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">214</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">215</td>
                                    <td class="row-source"><pre>        if (!success || result.length == 0) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">216</td>
                                    <td class="row-source"><pre>            if (useMockVerification) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">217</td>
                                    <td class="row-source"><pre>                return _mockVerify(message, publicKey, keccak256(publicKey));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">218</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">219</td>
                                    <td class="row-source"><pre>            revert PrecompileCallFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">220</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">221</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">222</td>
                                    <td class="row-source"><pre>        return abi.decode(result, (bool));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">223</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">224</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">225</td>
                                    <td class="row-source"><pre>    function _getSizes(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">226</td>
                                    <td class="row-source"><pre>        SPHINCSVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">227</td>
                                    <td class="row-source"><pre>    ) internal pure returns (uint256 pkSize, uint256 sigSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">228</td>
                                    <td class="row-source"><pre>        if (variant == SPHINCSVariant.SPHINCS_128s) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">229</td>
                                    <td class="row-source"><pre>            return (SPHINCS_128S_PK_SIZE, SPHINCS_128S_SIG_SIZE);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">230</td>
                                    <td class="row-source"><pre>        } else if (variant == SPHINCSVariant.SPHINCS_128f) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">231</td>
                                    <td class="row-source"><pre>            return (SPHINCS_128S_PK_SIZE, SPHINCS_128F_SIG_SIZE);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">232</td>
                                    <td class="row-source"><pre>        } else if (variant == SPHINCSVariant.SPHINCS_256s) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">233</td>
                                    <td class="row-source"><pre>            return (SPHINCS_256S_PK_SIZE, SPHINCS_256S_SIG_SIZE);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">234</td>
                                    <td class="row-source"><pre>        } else if (variant == SPHINCSVariant.SPHINCS_256f) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">235</td>
                                    <td class="row-source"><pre>            return (SPHINCS_256S_PK_SIZE, SPHINCS_256F_SIG_SIZE);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">236</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">237</td>
                                    <td class="row-source"><pre>        revert UnsupportedVariant();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">238</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">239</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">240</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">241</td>
                                    <td class="row-source"><pre>    // ADMIN FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">242</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">243</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">244</td>
                                    <td class="row-source"><pre>    function setMockMode(bool enabled) external onlyOwner {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">245</td>
                                    <td class="row-source"><pre>        useMockVerification = enabled;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">246</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">247</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">248</td>
                                    <td class="row-source"><pre>    function addTrustedKey(bytes32 keyHash) external onlyOwner {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">249</td>
                                    <td class="row-source"><pre>        trustedKeyHashes[keyHash] = true;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">250</td>
                                    <td class="row-source"><pre>        emit TrustedKeyAdded(keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">251</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">252</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">253</td>
                                    <td class="row-source"><pre>    function removeTrustedKey(bytes32 keyHash) external onlyOwner {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">254</td>
                                    <td class="row-source"><pre>        trustedKeyHashes[keyHash] = false;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">255</td>
                                    <td class="row-source"><pre>        emit TrustedKeyRemoved(keyHash);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">256</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">257</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">258</td>
                                    <td class="row-source"><pre>    function addPreVerified(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">259</td>
                                    <td class="row-source"><pre>        bytes32 message,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">260</td>
                                    <td class="row-source"><pre>        bytes32 signatureHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">261</td>
                                    <td class="row-source"><pre>        bytes32 publicKeyHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">262</td>
                                    <td class="row-source"><pre>    ) external onlyOwner {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">263</td>
                                    <td class="row-source"><pre>        bytes32 key = keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">264</td>
                                    <td class="row-source"><pre>            abi.encode(message, signatureHash, publicKeyHash)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">265</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">266</td>
                                    <td class="row-source"><pre>        preVerified[key] = true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">267</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">268</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">269</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">270</td>
                                    <td class="row-source"><pre>    // VIEW FUNCTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">271</td>
                                    <td class="row-source"><pre>    // =============================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">272</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">273</td>
                                    <td class="row-source"><pre>    function getExpectedSizes(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">274</td>
                                    <td class="row-source"><pre>        SPHINCSVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">275</td>
                                    <td class="row-source"><pre>    ) external pure returns (uint256 pkSize, uint256 sigSize) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">276</td>
                                    <td class="row-source"><pre>        return _getSizes(variant);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">277</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">278</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">279</td>
                                    <td class="row-source"><pre>    function isKeyTrusted(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">280</td>
                                    <td class="row-source"><pre>        bytes calldata publicKey</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">281</td>
                                    <td class="row-source"><pre>    ) external view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">282</td>
                                    <td class="row-source"><pre>        return trustedKeyHashes[keccak256(publicKey)];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">283</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">284</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">285</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">286</td>
                                    <td class="row-source"><pre>     * @notice Estimate gas for verification</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">287</td>
                                    <td class="row-source"><pre>     * @dev SPHINCS+ verification is more expensive due to hash computations</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">288</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">289</td>
                                    <td class="row-source"><pre>    function estimateGas(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">290</td>
                                    <td class="row-source"><pre>        SPHINCSVariant variant</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">291</td>
                                    <td class="row-source"><pre>    ) external pure returns (uint256) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">292</td>
                                    <td class="row-source"><pre>        if (</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">293</td>
                                    <td class="row-source"><pre>            variant == SPHINCSVariant.SPHINCS_128s ||</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">294</td>
                                    <td class="row-source"><pre>            variant == SPHINCSVariant.SPHINCS_128f</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">295</td>
                                    <td class="row-source"><pre>        ) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">296</td>
                                    <td class="row-source"><pre>            return 300_000;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">297</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">298</td>
                                    <td class="row-source"><pre>            return 500_000;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">299</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">300</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">301</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">302</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="contracts_test_echidna_EchidnaPQC_sol" data-file-path="contracts/test/echidna/EchidnaPQC.sol" data-lines-active="91" data-lines-covered="42">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(55, 90%, 50%, 0.15); color: hsl(55, 90%, 50%)">
                                46.0%
                            </span>
                            <span class="file-name">contracts/test/echidna/EchidnaPQC.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>42 / 91</strong> (46.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.22;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>import &quot;../../pqc/DilithiumVerifier.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre>import &quot;../../pqc/KyberKEM.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import &quot;../../pqc/PQCRegistry.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * @title EchidnaPQCTest</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * @notice Echidna property-based fuzzing for PQC contracts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * @dev Run with: echidna . --contract EchidnaPQCTest --test-limit 50000</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre>contract EchidnaPQCTest {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre>    DilithiumVerifier public dilithiumVerifier;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    KyberKEM public kyberKEM;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>    PQCRegistry public pqcRegistry;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>    // Ghost state for tracking</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>    uint256 public ghostTotalAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    uint256 public ghostTotalKeys;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    uint256 public ghostTotalExchanges;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    uint256 public ghostCompletedExchanges;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; bool) public ghostActiveAccounts;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; bool) public ghostActiveKeys;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    mapping(bytes32 =&gt; bool) public ghostCompletedExchangeIds;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    address[] public registeredUsers;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    bytes32[] public createdExchangeIds;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>    constructor() {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>        dilithiumVerifier = new DilithiumVerifier();</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>        kyberKEM = new KyberKEM();</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>        pqcRegistry = new PQCRegistry(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>            address(dilithiumVerifier),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>            address(0),</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>            address(kyberKEM)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>    // =========================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>    // ECHIDNA ACTIONS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>    // =========================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    function configurePQCAccount(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>        uint8 sigAlgoRaw,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>        uint8 kemAlgoRaw,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>        bytes32 sigKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>        bytes32 kemKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>        bool enableHybrid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>    ) public {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>        // Bound inputs to valid ranges</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCPrimitive sigAlgo = PQCRegistry.PQCPrimitive(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>            (sigAlgoRaw % 3) + 1</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>        ); // 1-3 are sig algos</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCPrimitive kemAlgo = kemAlgoRaw == 0</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>            ? PQCRegistry.PQCPrimitive.None</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>            : PQCRegistry.PQCPrimitive((kemAlgoRaw % 3) + 7); // 7-9 are KEM algos</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>        if (!ghostActiveAccounts[msg.sender]) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>            try</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>                pqcRegistry.configureAccount(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>                    sigAlgo,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>                    kemAlgo,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>                    sigKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>                    kemKeyHash,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>                    enableHybrid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>                )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>            {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>                ghostActiveAccounts[msg.sender] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>                ghostTotalAccounts++;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>                registeredUsers.push(msg.sender);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>            } catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>    function deactivatePQCAccount() public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>        if (ghostActiveAccounts[msg.sender]) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>            try pqcRegistry.deactivateAccount() {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>                ghostActiveAccounts[msg.sender] = false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>            } catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>    function registerKyberKey(uint8 variantRaw) public {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>        KyberKEM.KyberVariant variant = KyberKEM.KyberVariant(variantRaw % 3);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>        uint256 keySize;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>        if (variant == KyberKEM.KyberVariant.Kyber512) keySize = 800;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>        else if (variant == KyberKEM.KyberVariant.Kyber768) keySize = 1184;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>        else keySize = 1568;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>        bytes memory publicKey = new bytes(keySize);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>        if (!ghostActiveKeys[msg.sender]) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>            try kyberKEM.registerPublicKey(publicKey, variant) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>                ghostActiveKeys[msg.sender] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>                ghostTotalKeys++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>            } catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>    function revokeKyberKey() public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>        if (ghostActiveKeys[msg.sender]) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>            try kyberKEM.revokeKey() {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>                ghostActiveKeys[msg.sender] = false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>            } catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>    function initiateKeyExchange(address recipient, bytes32 randomness) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>        if (ghostActiveKeys[recipient] &amp;&amp; recipient != msg.sender) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>            try kyberKEM.encapsulate(recipient, randomness) returns (</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>                bytes32 exchangeId,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>                bytes memory,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>                bytes32</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>            ) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>                createdExchangeIds.push(exchangeId);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>                ghostTotalExchanges++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>            } catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>    function confirmKeyExchange(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>        uint256 exchangeIndex,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>        bytes32 sharedSecretHash</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>    ) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>        if (exchangeIndex &lt; createdExchangeIds.length) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>            bytes32 exchangeId = createdExchangeIds[exchangeIndex];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>            if (!ghostCompletedExchangeIds[exchangeId]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>                try</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>                    kyberKEM.confirmDecapsulation(exchangeId, sharedSecretHash)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>                {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>                    ghostCompletedExchangeIds[exchangeId] = true;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>                    ghostCompletedExchanges++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>                } catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>    function addTrustedDilithiumKey(bytes32 keyHash) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>        try dilithiumVerifier.addTrustedKey(keyHash) {} catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>    function removeTrustedDilithiumKey(bytes32 keyHash) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>        try dilithiumVerifier.removeTrustedKey(keyHash) {} catch {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>    // =========================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>    // ECHIDNA INVARIANTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>    // =========================================================================</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>     * @notice INV-001: Ghost account count matches registry stats</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>    function echidna_account_count_consistent() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCStats memory stats = pqcRegistry.getStats();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>        // Allow for some discrepancy due to deactivations</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>        return stats.totalAccounts &lt;= ghostTotalAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>     * @notice INV-002: Completed exchanges never exceed total exchanges</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>    function echidna_completed_never_exceeds_total()</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>        public</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>        view</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre>        returns (bool)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>        return ghostCompletedExchanges &lt;= ghostTotalExchanges;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>     * @notice INV-003: Active keys count is consistent</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>    function echidna_active_keys_consistent() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>        uint256 activeCount = 0;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre>        for (uint256 i = 0; i &lt; registeredUsers.length; i++) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>            (, , , bool isActive) = kyberKEM.registeredKeys(registeredUsers[i]);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>            if (isActive) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>                activeCount++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>        return activeCount &lt;= ghostTotalKeys;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>     * @notice INV-004: PQC enabled accounts have valid config</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>    function echidna_enabled_accounts_valid() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>        for (uint256 i = 0; i &lt; registeredUsers.length; i++) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>            address user = registeredUsers[i];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre>            if (pqcRegistry.isPQCEnabled(user)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>                PQCRegistry.AccountPQConfig memory config = pqcRegistry</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>                    .getAccountConfig(user);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre>                if (!config.isActive) return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>     * @notice INV-005: Dilithium accounts + SPHINCS accounts &lt;= total accounts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>    function echidna_signature_accounts_bounded() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCStats memory stats = pqcRegistry.getStats();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>        return</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre>            stats.dilithiumAccounts + stats.sphincsAccounts &lt;=</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">209</td>
                                    <td class="row-source"><pre>            stats.totalAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">210</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">211</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">212</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">213</td>
                                    <td class="row-source"><pre>     * @notice INV-006: Kyber accounts &lt;= total accounts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">214</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">215</td>
                                    <td class="row-source"><pre>    function echidna_kyber_accounts_bounded() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">216</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCStats memory stats = pqcRegistry.getStats();</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">217</td>
                                    <td class="row-source"><pre>        return stats.kyberAccounts &lt;= stats.totalAccounts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">218</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">219</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">220</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">221</td>
                                    <td class="row-source"><pre>     * @notice INV-007: Completed exchange IDs are actually completed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">222</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">223</td>
                                    <td class="row-source"><pre>    function echidna_completed_exchanges_valid() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">224</td>
                                    <td class="row-source"><pre>        for (uint256 i = 0; i &lt; createdExchangeIds.length; i++) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">225</td>
                                    <td class="row-source"><pre>            bytes32 exchangeId = createdExchangeIds[i];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">226</td>
                                    <td class="row-source"><pre>            if (ghostCompletedExchangeIds[exchangeId]) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">227</td>
                                    <td class="row-source"><pre>                if (!kyberKEM.isExchangeCompleted(exchangeId)) return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">228</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">229</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">230</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">231</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">232</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">233</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">234</td>
                                    <td class="row-source"><pre>     * @notice INV-008: Stats never decrease (signature verifications)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">235</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">236</td>
                                    <td class="row-source"><pre>    function echidna_stats_monotonic() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">237</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCStats memory stats = pqcRegistry.getStats();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">238</td>
                                    <td class="row-source"><pre>        // Stats should always be &gt;= 0 (uint256 guarantees this)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">239</td>
                                    <td class="row-source"><pre>        return</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">240</td>
                                    <td class="row-source"><pre>            stats.totalSignatureVerifications &gt;= 0 &amp;&amp;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">241</td>
                                    <td class="row-source"><pre>            stats.totalKeyEncapsulations &gt;= 0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">242</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">243</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">244</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">245</td>
                                    <td class="row-source"><pre>     * @notice INV-009: Ghost active accounts match registry state</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">246</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">247</td>
                                    <td class="row-source"><pre>    function echidna_ghost_accounts_sync() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">248</td>
                                    <td class="row-source"><pre>        for (uint256 i = 0; i &lt; registeredUsers.length; i++) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">249</td>
                                    <td class="row-source"><pre>            address user = registeredUsers[i];</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">250</td>
                                    <td class="row-source"><pre>            bool registryState = pqcRegistry.isPQCEnabled(user);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">251</td>
                                    <td class="row-source"><pre>            bool ghostState = ghostActiveAccounts[user];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">252</td>
                                    <td class="row-source"><pre>            // If ghost says active, registry should agree</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">253</td>
                                    <td class="row-source"><pre>            // (reverse may not hold due to deactivation)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">254</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">255</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">256</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">257</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">258</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">259</td>
                                    <td class="row-source"><pre>     * @notice INV-010: Ghost active keys match KyberKEM state</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">260</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">261</td>
                                    <td class="row-source"><pre>    function echidna_ghost_keys_sync() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">262</td>
                                    <td class="row-source"><pre>        for (uint256 i = 0; i &lt; registeredUsers.length; i++) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">263</td>
                                    <td class="row-source"><pre>            address user = registeredUsers[i];</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">264</td>
                                    <td class="row-source"><pre>            (, , , bool isActive) = kyberKEM.registeredKeys(user);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">265</td>
                                    <td class="row-source"><pre>            bool ghostState = ghostActiveKeys[user];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">266</td>
                                    <td class="row-source"><pre>            // States should be in sync (allowing for revocation lag)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">267</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">268</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">269</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">270</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">271</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">272</td>
                                    <td class="row-source"><pre>     * @notice INV-011: Exchange creation requires active recipient key</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">273</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">274</td>
                                    <td class="row-source"><pre>    function echidna_exchange_requires_recipient_key()</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">275</td>
                                    <td class="row-source"><pre>        public</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">276</td>
                                    <td class="row-source"><pre>        view</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">277</td>
                                    <td class="row-source"><pre>        returns (bool)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">278</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">279</td>
                                    <td class="row-source"><pre>        // This is enforced by the contract, so always true if tests pass</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">280</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">281</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">282</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">283</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">284</td>
                                    <td class="row-source"><pre>     * @notice INV-012: No overflow in statistics</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">285</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">286</td>
                                    <td class="row-source"><pre>    function echidna_no_stats_overflow() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">287</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCStats memory stats = pqcRegistry.getStats();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">288</td>
                                    <td class="row-source"><pre>        return</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">289</td>
                                    <td class="row-source"><pre>            stats.totalAccounts &lt; type(uint256).max &amp;&amp;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">290</td>
                                    <td class="row-source"><pre>            stats.dilithiumAccounts &lt; type(uint256).max &amp;&amp;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">291</td>
                                    <td class="row-source"><pre>            stats.sphincsAccounts &lt; type(uint256).max &amp;&amp;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">292</td>
                                    <td class="row-source"><pre>            stats.kyberAccounts &lt; type(uint256).max;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">293</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">294</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">295</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">296</td>
                                    <td class="row-source"><pre>     * @notice INV-013: Phase is always valid</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">297</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">298</td>
                                    <td class="row-source"><pre>    function echidna_phase_valid() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">299</td>
                                    <td class="row-source"><pre>        uint8 phase = uint8(pqcRegistry.currentPhase());</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">300</td>
                                    <td class="row-source"><pre>        return phase &lt;= 4; // 0-4 are valid phases</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">301</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">302</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">303</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">304</td>
                                    <td class="row-source"><pre>     * @notice INV-014: Hybrid verification count &lt;= total verifications</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">305</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">306</td>
                                    <td class="row-source"><pre>    function echidna_hybrid_bounded() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">307</td>
                                    <td class="row-source"><pre>        PQCRegistry.PQCStats memory stats = pqcRegistry.getStats();</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">308</td>
                                    <td class="row-source"><pre>        return stats.hybridVerifications &lt;= stats.totalSignatureVerifications;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">309</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">310</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">311</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">312</td>
                                    <td class="row-source"><pre>     * @notice INV-015: Registered users list is bounded</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">313</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">314</td>
                                    <td class="row-source"><pre>    function echidna_users_bounded() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">315</td>
                                    <td class="row-source"><pre>        return registeredUsers.length &lt;= 1000; // Reasonable bound for testing</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">316</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">317</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">318</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_access_AccessControl_sol" data-file-path="node_modules/@openzeppelin/contracts/access/AccessControl.sol" data-lines-active="23" data-lines-covered="7">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(36, 90%, 50%, 0.15); color: hsl(36, 90%, 50%)">
                                30.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/access/AccessControl.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>7 / 23</strong> (30.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.4.0) (access/AccessControl.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import {IAccessControl} from &quot;./IAccessControl.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre>import {Context} from &quot;../utils/Context.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>import {IERC165, ERC165} from &quot;../utils/introspection/ERC165.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * @dev Contract module that allows children to implement role-based access</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * control mechanisms. This is a lightweight version that doesn&#39;t allow enumerating role</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * members except through off-chain means by accessing the contract event logs. Some</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * applications may benefit from on-chain enumerability, for those cases see</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> * {AccessControlEnumerable}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre> * Roles are referred to by their `bytes32` identifier. These should be exposed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre> * in the external API and be unique. The best way to achieve this is by</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre> * using `public constant` hash digests:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre> * ```solidity</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre> * bytes32 public constant MY_ROLE = keccak256(&quot;MY_ROLE&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre> * ```</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre> * Roles can be used to represent a set of permissions. To restrict access to a</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre> * function call, use {hasRole}:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre> * ```solidity</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre> * function foo() public {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre> *     require(hasRole(MY_ROLE, msg.sender));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre> *     ...</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre> * }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre> * ```</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre> * Roles can be granted and revoked dynamically via the {grantRole} and</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre> * {revokeRole} functions. Each role has an associated admin role, and only</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre> * accounts that have a role&#39;s admin role can call {grantRole} and {revokeRole}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre> * By default, the admin role for all roles is `DEFAULT_ADMIN_ROLE`, which means</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre> * that only accounts with this role will be able to grant or revoke other</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre> * roles. More complex role relationships can be created by using</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre> * {_setRoleAdmin}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre> * WARNING: The `DEFAULT_ADMIN_ROLE` is also its own admin: it has permission to</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre> * grant and revoke this role. Extra precautions should be taken to secure</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre> * accounts that have been granted it. We recommend using {AccessControlDefaultAdminRules}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre> * to enforce additional security measures for this role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>abstract contract AccessControl is Context, IAccessControl, ERC165 {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>    struct RoleData {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>        mapping(address account =&gt; bool) hasRole;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>        bytes32 adminRole;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>    mapping(bytes32 role =&gt; RoleData) private _roles;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>    bytes32 public constant DEFAULT_ADMIN_ROLE = 0x00;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>     * @dev Modifier that checks that an account has a specific role. Reverts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>     * with an {AccessControlUnauthorizedAccount} error including the required role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>    modifier onlyRole(bytes32 role) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>        _checkRole(role);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>        _;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>    /// @inheritdoc IERC165</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>        return interfaceId == type(IAccessControl).interfaceId || super.supportsInterface(interfaceId);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>     * @dev Returns `true` if `account` has been granted `role`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>    function hasRole(bytes32 role, address account) public view virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>        return _roles[role].hasRole[account];</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>     * @dev Reverts with an {AccessControlUnauthorizedAccount} error if `_msgSender()`</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>     * is missing `role`. Overriding this function changes the behavior of the {onlyRole} modifier.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>    function _checkRole(bytes32 role) internal view virtual {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>        _checkRole(role, _msgSender());</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>     * @dev Reverts with an {AccessControlUnauthorizedAccount} error if `account`</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>     * is missing `role`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>    function _checkRole(bytes32 role, address account) internal view virtual {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>        if (!hasRole(role, account)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>            revert AccessControlUnauthorizedAccount(account, role);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>     * @dev Returns the admin role that controls `role`. See {grantRole} and</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre>     * {revokeRole}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>     * To change a role&#39;s admin, use {_setRoleAdmin}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>    function getRoleAdmin(bytes32 role) public view virtual returns (bytes32) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>        return _roles[role].adminRole;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>     * @dev Grants `role` to `account`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>     * If `account` had not been already granted `role`, emits a {RoleGranted}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>     * event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>     * - the caller must have ``role``&#39;s admin role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>     * May emit a {RoleGranted} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>    function grantRole(bytes32 role, address account) public virtual onlyRole(getRoleAdmin(role)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>        _grantRole(role, account);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>     * @dev Revokes `role` from `account`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>     * If `account` had been granted `role`, emits a {RoleRevoked} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>     * - the caller must have ``role``&#39;s admin role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>     * May emit a {RoleRevoked} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>    function revokeRole(bytes32 role, address account) public virtual onlyRole(getRoleAdmin(role)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>        _revokeRole(role, account);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre>     * @dev Revokes `role` from the calling account.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>     * Roles are often managed via {grantRole} and {revokeRole}: this function&#39;s</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>     * purpose is to provide a mechanism for accounts to lose their privileges</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre>     * if they are compromised (such as when a trusted device is misplaced).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>     * If the calling account had been revoked `role`, emits a {RoleRevoked}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>     * event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>     * - the caller must be `callerConfirmation`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>     * May emit a {RoleRevoked} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>    function renounceRole(bytes32 role, address callerConfirmation) public virtual {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>        if (callerConfirmation != _msgSender()) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>            revert AccessControlBadConfirmation();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>        _revokeRole(role, callerConfirmation);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>     * @dev Sets `adminRole` as ``role``&#39;s admin role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>     * Emits a {RoleAdminChanged} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre>    function _setRoleAdmin(bytes32 role, bytes32 adminRole) internal virtual {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>        bytes32 previousAdminRole = getRoleAdmin(role);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>        _roles[role].adminRole = adminRole;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>        emit RoleAdminChanged(role, previousAdminRole, adminRole);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>     * @dev Attempts to grant `role` to `account` and returns a boolean indicating if `role` was granted.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>     * Internal function without access restriction.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>     * May emit a {RoleGranted} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>    function _grantRole(bytes32 role, address account) internal virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre>        if (!hasRole(role, account)) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>            _roles[role].hasRole[account] = true;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>            emit RoleGranted(role, account, _msgSender());</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>            return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>            return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>     * @dev Attempts to revoke `role` from `account` and returns a boolean indicating if `role` was revoked.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>     * Internal function without access restriction.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre>     * May emit a {RoleRevoked} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>    function _revokeRole(bytes32 role, address account) internal virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>        if (hasRole(role, account)) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>            _roles[role].hasRole[account] = false;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>            emit RoleRevoked(role, account, _msgSender());</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>            return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>            return false;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_access_IAccessControl_sol" data-file-path="node_modules/@openzeppelin/contracts/access/IAccessControl.sol" data-lines-active="0" data-lines-covered="0">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(0, 90%, 50%, 0.15); color: hsl(0, 90%, 50%)">
                                0.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/access/IAccessControl.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>0 / 0</strong> (0.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.4.0) (access/IAccessControl.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity &gt;=0.8.4;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @dev External interface of AccessControl declared to support ERC-165 detection.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre>interface IAccessControl {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre>     * @dev The `account` is missing a role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre>    error AccessControlUnauthorizedAccount(address account, bytes32 neededRole);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>     * @dev The caller of a function is not the expected one.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>     * NOTE: Don&#39;t confuse with {AccessControlUnauthorizedAccount}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    error AccessControlBadConfirmation();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>     * @dev Emitted when `newAdminRole` is set as ``role``&#39;s admin role, replacing `previousAdminRole`</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>     * `DEFAULT_ADMIN_ROLE` is the starting admin for all roles, despite</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>     * {RoleAdminChanged} not being emitted to signal this.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    event RoleAdminChanged(bytes32 indexed role, bytes32 indexed previousAdminRole, bytes32 indexed newAdminRole);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>     * @dev Emitted when `account` is granted `role`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>     * `sender` is the account that originated the contract call. This account bears the admin role (for the granted role).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>     * Expected in cases where the role was granted using the internal {AccessControl-_grantRole}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>    event RoleGranted(bytes32 indexed role, address indexed account, address indexed sender);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>     * @dev Emitted when `account` is revoked `role`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>     * `sender` is the account that originated the contract call:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>     *   - if using `revokeRole`, it is the admin role bearer</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>     *   - if using `renounceRole`, it is the role bearer (i.e. `account`)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    event RoleRevoked(bytes32 indexed role, address indexed account, address indexed sender);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>     * @dev Returns `true` if `account` has been granted `role`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>    function hasRole(bytes32 role, address account) external view returns (bool);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>     * @dev Returns the admin role that controls `role`. See {grantRole} and</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>     * {revokeRole}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>     * To change a role&#39;s admin, use {AccessControl-_setRoleAdmin}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>    function getRoleAdmin(bytes32 role) external view returns (bytes32);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>     * @dev Grants `role` to `account`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>     * If `account` had not been already granted `role`, emits a {RoleGranted}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>     * event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>     * - the caller must have ``role``&#39;s admin role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>    function grantRole(bytes32 role, address account) external;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>     * @dev Revokes `role` from `account`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>     * If `account` had been granted `role`, emits a {RoleRevoked} event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>     * - the caller must have ``role``&#39;s admin role.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>    function revokeRole(bytes32 role, address account) external;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>     * @dev Revokes `role` from the calling account.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>     * Roles are often managed via {grantRole} and {revokeRole}: this function&#39;s</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>     * purpose is to provide a mechanism for accounts to lose their privileges</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>     * if they are compromised (such as when a trusted device is misplaced).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>     * If the calling account had been granted `role`, emits a {RoleRevoked}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>     * event.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>     * - the caller must be `callerConfirmation`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>    function renounceRole(bytes32 role, address callerConfirmation) external;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_access_Ownable_sol" data-file-path="node_modules/@openzeppelin/contracts/access/Ownable.sol" data-lines-active="11" data-lines-covered="6">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(64, 90%, 45%, 0.15); color: hsl(64, 90%, 45%)">
                                54.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/access/Ownable.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>6 / 11</strong> (54.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.0.0) (access/Ownable.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import {Context} from &quot;../utils/Context.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * @dev Contract module which provides a basic access control mechanism, where</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * there is an account (an owner) that can be granted exclusive access to</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * specific functions.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * The initial owner is set to the address provided by the deployer. This can</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * later be changed with {transferOwnership}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> * This module is used through inheritance. It will make available the modifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre> * `onlyOwner`, which can be applied to your functions to restrict their use to</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre> * the owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>abstract contract Ownable is Context {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    address private _owner;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>     * @dev The caller account is not authorized to perform an operation.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    error OwnableUnauthorizedAccount(address account);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>     * @dev The owner is not a valid owner account. (eg. `address(0)`)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>    error OwnableInvalidOwner(address owner);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>     * @dev Initializes the contract setting the address provided by the deployer as the initial owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    constructor(address initialOwner) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>        if (initialOwner == address(0)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>            revert OwnableInvalidOwner(address(0));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>        _transferOwnership(initialOwner);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>     * @dev Throws if called by any account other than the owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>    modifier onlyOwner() {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>        _checkOwner();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>        _;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>     * @dev Returns the address of the current owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>    function owner() public view virtual returns (address) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>        return _owner;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>     * @dev Throws if the sender is not the owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>    function _checkOwner() internal view virtual {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>        if (owner() != _msgSender()) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>            revert OwnableUnauthorizedAccount(_msgSender());</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>     * @dev Leaves the contract without owner. It will not be possible to call</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>     * `onlyOwner` functions. Can only be called by the current owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>     * NOTE: Renouncing ownership will leave the contract without an owner,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>     * thereby disabling any functionality that is only available to the owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>    function renounceOwnership() public virtual onlyOwner {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>        _transferOwnership(address(0));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>     * @dev Transfers ownership of the contract to a new account (`newOwner`).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>     * Can only be called by the current owner.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>    function transferOwnership(address newOwner) public virtual onlyOwner {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>        if (newOwner == address(0)) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>            revert OwnableInvalidOwner(address(0));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>        _transferOwnership(newOwner);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>     * @dev Transfers ownership of the contract to a new account (`newOwner`).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>     * Internal function without access restriction.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>    function _transferOwnership(address newOwner) internal virtual {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>        address oldOwner = _owner;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>        _owner = newOwner;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>        emit OwnershipTransferred(oldOwner, newOwner);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_utils_Context_sol" data-file-path="node_modules/@openzeppelin/contracts/utils/Context.sol" data-lines-active="1" data-lines-covered="1">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(120, 90%, 45%, 0.15); color: hsl(120, 90%, 45%)">
                                100.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/utils/Context.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>1 / 1</strong> (100.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.0.1) (utils/Context.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @dev Provides information about the current execution context, including the</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * sender of the transaction and its data. While these are generally available</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * via msg.sender and msg.data, they should not be accessed in such a direct</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * manner, since when dealing with meta-transactions the account sending and</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * paying for execution may not be the actual sender (as far as an application</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * is concerned).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * This contract is only required for intermediate, library-like contracts.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>abstract contract Context {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>    function _msgSender() internal view virtual returns (address) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>        return msg.sender;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    function _msgData() internal view virtual returns (bytes calldata) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>        return msg.data;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    function _contextSuffixLength() internal view virtual returns (uint256) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>        return 0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_utils_Pausable_sol" data-file-path="node_modules/@openzeppelin/contracts/utils/Pausable.sol" data-lines-active="10" data-lines-covered="4">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(48, 90%, 50%, 0.15); color: hsl(48, 90%, 50%)">
                                40.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/utils/Pausable.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>4 / 10</strong> (40.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.3.0) (utils/Pausable.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import {Context} from &quot;../utils/Context.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * @dev Contract module which allows children to implement an emergency stop</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * mechanism that can be triggered by an authorized account.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * This module is used through inheritance. It will make available the</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * modifiers `whenNotPaused` and `whenPaused`, which can be applied to</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * the functions of your contract. Note that they will not be pausable by</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> * simply including this module, only once the modifiers are put in place.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>abstract contract Pausable is Context {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>    bool private _paused;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>     * @dev Emitted when the pause is triggered by `account`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    event Paused(address account);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>     * @dev Emitted when the pause is lifted by `account`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    event Unpaused(address account);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>     * @dev The operation failed because the contract is paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    error EnforcedPause();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>     * @dev The operation failed because the contract is not paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    error ExpectedPause();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>     * @dev Modifier to make a function callable only when the contract is not paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>     * - The contract must not be paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    modifier whenNotPaused() {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>        _requireNotPaused();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>        _;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>     * @dev Modifier to make a function callable only when the contract is paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>     * - The contract must be paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>    modifier whenPaused() {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>        _requirePaused();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>        _;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>     * @dev Returns true if the contract is paused, and false otherwise.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>    function paused() public view virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>        return _paused;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>     * @dev Throws if the contract is paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>    function _requireNotPaused() internal view virtual {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>        if (paused()) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>            revert EnforcedPause();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>     * @dev Throws if the contract is not paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>    function _requirePaused() internal view virtual {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>        if (!paused()) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>            revert ExpectedPause();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>     * @dev Triggers stopped state.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>     * - The contract must not be paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>    function _pause() internal virtual whenNotPaused {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>        _paused = true;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>        emit Paused(_msgSender());</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>     * @dev Returns to normal state.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>     * - The contract must be paused.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>    function _unpause() internal virtual whenPaused {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>        _paused = false;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>        emit Unpaused(_msgSender());</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_utils_introspection_ERC165_sol" data-file-path="node_modules/@openzeppelin/contracts/utils/introspection/ERC165.sol" data-lines-active="1" data-lines-covered="0">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(0, 90%, 50%, 0.15); color: hsl(0, 90%, 50%)">
                                0.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/utils/introspection/ERC165.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>0 / 1</strong> (0.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.4.0) (utils/introspection/ERC165.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import {IERC165} from &quot;./IERC165.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * @dev Implementation of the {IERC165} interface.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * Contracts that want to implement ERC-165 should inherit from this contract and override {supportsInterface} to check</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * for the additional interface id that will be supported. For example:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * ```solidity</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre> * }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre> * ```</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>abstract contract ERC165 is IERC165 {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    /// @inheritdoc IERC165</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    function supportsInterface(bytes4 interfaceId) public view virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>        return interfaceId == type(IERC165).interfaceId;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="node_modules__openzeppelin_contracts_utils_introspection_IERC165_sol" data-file-path="node_modules/@openzeppelin/contracts/utils/introspection/IERC165.sol" data-lines-active="0" data-lines-covered="0">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(0, 90%, 50%, 0.15); color: hsl(0, 90%, 50%)">
                                0.0%
                            </span>
                            <span class="file-name">node_modules/@openzeppelin/contracts/utils/introspection/IERC165.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>0 / 0</strong> (0.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.4.0) (utils/introspection/IERC165.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity &gt;=0.4.16;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @dev Interface of the ERC-165 standard, as defined in the</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * https://eips.ethereum.org/EIPS/eip-165[ERC].</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * Implementers can declare support of contract interfaces, which can then be</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * queried by others ({ERC165Checker}).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * For an implementation, see {ERC165}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>interface IERC165 {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>     * @dev Returns true if this contract implements the interface defined by</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>     * `interfaceId`. See the corresponding</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[ERC section]</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>     * to learn more about how these ids are created.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>     * This function call must use less than 30 000 gas.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    function supportsInterface(bytes4 interfaceId) external view returns (bool);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div>Report generated by <a href="https://github.com/crytic/echidna" target="_blank">Echidna</a> on January 22, 2026 at 03:05:12 UTC</div>
        </footer>
    </div>
    <script>
// Initialize the application when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    initSourceFileExpansion();
    initializeFileTree();
    initResizer();
});

// Initialize source file expansion behavior
function initSourceFileExpansion() {
    document.querySelectorAll('.source-file').forEach(file => {
        const header = file.querySelector('.source-file-header');
        header.addEventListener('click', () => {
            file.classList.toggle('expanded');
            const chevron = header.querySelector('.chevron-icon');
            chevron.style.transform = file.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0)';
        });
    });
}

// Initialize the resizer functionality
function initResizer() {
    const fileExplorer = document.getElementById('file-explorer');
    const resizer = document.getElementById('file-explorer-resizer');
    let startX, startWidth;

    // Handle mousedown on the resizer
    resizer.addEventListener('mousedown', e => {
        startX = e.clientX;
        startWidth = parseInt(window.getComputedStyle(fileExplorer).width, 10);

        // Add event listeners for resizing
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);

        // Prevent text selection during resize
        document.body.style.userSelect = 'none';
        document.body.style.cursor = 'col-resize';
    });

    // Handle mousemove for resizing
    function handleMouseMove(e) {
        const newWidth = startWidth + (e.clientX - startX);

        // Apply width constraints
        if (newWidth >= 200 && newWidth <= 500) {
            fileExplorer.style.width = newWidth + 'px';
            fileExplorer.style.flex = `0 0 ${newWidth}px`;
        }
    }

    // Handle mouseup to end resizing
    function handleMouseUp() {
        document.removeEventListener('mousemove', handleMouseMove);
        document.removeEventListener('mouseup', handleMouseUp);
        document.body.style.userSelect = '';
        document.body.style.cursor = '';
    }
}

// Helper function to get color based on coverage percentage
function getCoverageColor(percentage) {
    return percentage < 50
        ? `hsl(${percentage * 1.2}, 90%, 50%)`
        : `hsl(${60 + (percentage - 50) * 1.2}, 90%, 45%)`;
}

// Helper function for transparent background with coverage color
function getCoverageColorAlpha(percentage) {
    return percentage < 50
        ? `hsla(${percentage * 1.2}, 90%, 50%, 0.15)`
        : `hsla(${60 + (percentage - 50) * 1.2}, 90%, 45%, 0.15)`;
}

// Build file tree structure from file paths
function buildFileTree() {
    const root = { name: '', type: 'directory', children: {}, path: '' };
    const sourceFiles = document.getElementsByClassName("source-file");

    // First pass: build the tree structure
    for (let i = 0; i < sourceFiles.length; i++) {
        const filePath = sourceFiles[i].dataset.filePath;
        const pathParts = filePath.split(/[\/\\]+/);
        let current = root;
        let currentPath = '';

        for (let j = 0; j < pathParts.length; j++) {
            const part = pathParts[j];
            if (part === '') continue;

            currentPath += (currentPath ? '/' : '') + part;

            if (j === pathParts.length - 1) {
                // This is a file
                current.children[part] = {
                    name: part,
                    type: 'file',
                    path: filePath,
                    element: sourceFiles[i],
                    coveredLines: parseInt(sourceFiles[i].dataset.linesCovered),
                    activeLines: parseInt(sourceFiles[i].dataset.linesActive)
                };
            } else {
                // This is a directory
                if (!current.children[part]) {
                    current.children[part] = {
                        name: part,
                        type: 'directory',
                        children: {},
                        path: currentPath
                    };
                }
                current = current.children[part];
            }
        }
    }

    // Second pass: calculate directory coverage
    calculateDirectoryCoverage(root);

    return root;
}

// Calculate coverage for directories by aggregating file coverage
function calculateDirectoryCoverage(node) {
    if (node.type === 'file') {
        return {
            coveredLines: node.coveredLines,
            activeLines: node.activeLines
        };
    }

    let totalCovered = 0;
    let totalActive = 0;

    for (const childName in node.children) {
        const child = node.children[childName];
        const { coveredLines, activeLines } = calculateDirectoryCoverage(child);
        totalCovered += coveredLines;
        totalActive += activeLines;
    }

    node.coveredLines = totalCovered;
    node.activeLines = totalActive;

    return {
        coveredLines: totalCovered,
        activeLines: totalActive
    };
}

// Render the file tree to the DOM
function renderFileTree(node, parentElement, isRoot = false) {
    const list = isRoot ? parentElement : document.createElement('ul');

    // Sort children: directories first, then files, both alphabetically
    const sortedChildren = Object.values(node.children).sort((a, b) => {
        if (a.type !== b.type) return a.type === 'directory' ? -1 : 1;
        return a.name.localeCompare(b.name);
    });

    for (const child of sortedChildren) {
        const li = document.createElement('li');
        li.className = child.type;

        // Create item container
        const itemDiv = document.createElement('div');
        itemDiv.className = 'file-item';

        // Create toggle button for directories
        const toggle = document.createElement('span');
        toggle.className = 'file-toggle';
        itemDiv.appendChild(toggle);

        // Create file/folder icon
        const icon = document.createElement('span');
        icon.className = 'file-icon';
        itemDiv.appendChild(icon);

        // Create name span
        const nameSpan = document.createElement('span');
        nameSpan.className = 'file-name';
        nameSpan.textContent = child.name;
        itemDiv.appendChild(nameSpan);

        // Add coverage indicator
        if (child.activeLines > 0) {
            const coverage = document.createElement('span');
            coverage.className = 'file-coverage';
            const percentage = Math.round((child.coveredLines / child.activeLines) * 100);
            coverage.style.backgroundColor = getCoverageColor(percentage);
            coverage.title = `${child.coveredLines}/${child.activeLines} lines covered (${percentage}%)`;
            itemDiv.appendChild(coverage);
        }

        li.appendChild(itemDiv);

        // Handle click events
        if (child.type === 'directory') {
            toggle.addEventListener('click', e => {
                e.stopPropagation();
                li.classList.toggle('expanded');
            });

            itemDiv.addEventListener('click', () => {
                li.classList.toggle('expanded');
            });

            // Recursively render children
            renderFileTree(child, li);
        } else {
            // Add click handler for files
            itemDiv.addEventListener('click', () => {
                // Deactivate all other items
                document.querySelectorAll('.file-item.active').forEach(el => {
                    el.classList.remove('active');
                });

                // Activate this item
                itemDiv.classList.add('active');

                // Navigate to the file
                const fileElement = child.element;
                fileElement.scrollIntoView({ behavior: 'smooth' });

                // Expand the file if it's collapsed
                if (!fileElement.classList.contains('expanded')) {
                    fileElement.querySelector('.source-file-header').click();
                }
            });
        }

        list.appendChild(li);
    }

    if (!isRoot) {
        parentElement.appendChild(list);
    }
}

// Initialize the file tree
function initializeFileTree() {
    const fileTreeRoot = document.getElementById('file-tree-root');
    const fileTree = buildFileTree();
    renderFileTree(fileTree, fileTreeRoot, true);

    // Expand the first level directories by default
    document.querySelectorAll('#file-tree-root > li.directory').forEach(dir => {
        dir.classList.add('expanded');
    });

    // Initialize search functionality
    initializeFileSearch();
}

// Initialize file search functionality
function initializeFileSearch() {
    const searchInput = document.getElementById('file-search-input');
    const clearButton = document.getElementById('file-search-clear');
    const noResultsMessage = document.getElementById('search-no-results');

    // Debounce function to limit how often the search is performed during typing
    function debounce(func, delay) {
        let timeout;
        return function() {
            const context = this;
            const args = arguments;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), delay);
        };
    }

    // Function to highlight text that matches the search term
    function highlightText(element, searchTerm) {
        const text = element.textContent;

        if (!searchTerm) {
            // Clear any existing highlights
            element.textContent = text;
            return false;
        }

        const lowerText = text.toLowerCase();
        const lowerSearchTerm = searchTerm.toLowerCase();

        if (lowerText.includes(lowerSearchTerm)) {
            const startIndex = lowerText.indexOf(lowerSearchTerm);
            const endIndex = startIndex + lowerSearchTerm.length;

            const beforeMatch = text.substring(0, startIndex);
            const match = text.substring(startIndex, endIndex);
            const afterMatch = text.substring(endIndex);

            element.innerHTML = beforeMatch + '<span class="search-highlight">' + match + '</span>' + afterMatch;
            return true;
        }

        element.textContent = text;
        return false;
    }

    // Function to filter the file tree based on search term
    function filterFileTree(searchTerm) {
        const fileTreeItems = document.querySelectorAll('.file-tree li');
        let hasVisibleItems = false;

        if (searchTerm === '') {
            // If search is cleared, show everything and reset expansion state
            fileTreeItems.forEach(item => {
                const nameElement = item.querySelector('.file-name');
                highlightText(nameElement, ''); // Clear highlights
                item.style.display = '';

                // Only expand first level by default
                if (item.classList.contains('directory')) {
                    // Check if this is a direct child of the root file tree
                    if (item.parentElement.id === 'file-tree-root') {
                        item.classList.add('expanded');
                    } else {
                        item.classList.remove('expanded');
                    }
                }
            });
        } else {
            // Two-pass filtering for search

            // First pass: hide everything and find matches
            const matchingItems = [];
            fileTreeItems.forEach(item => {
                const nameElement = item.querySelector('.file-name');
                const isMatch = highlightText(nameElement, searchTerm);
                item.style.display = 'none'; // Hide everything initially

                if (isMatch) {
                    matchingItems.push(item);
                }
            });

            // Second pass: show matching items and all their ancestor directories
            matchingItems.forEach(item => {
                hasVisibleItems = true;

                // Show the matching item
                item.style.display = '';

                // Show and expand all parent directories
                let parent = item.parentElement.closest('li.directory');
                while (parent) {
                    parent.style.display = '';
                    parent.classList.add('expanded');
                    parent = parent.parentElement.closest('li.directory');
                }
            });
        }

        // Show/hide the "no results" message
        noResultsMessage.style.display = searchTerm && !hasVisibleItems ? 'block' : 'none';
    }

    // Debounced search function to avoid excessive filtering while typing
    const debouncedSearch = debounce(filterFileTree, 200);

    // Search input event
    searchInput.addEventListener('input', function() {
        debouncedSearch(this.value.trim());
    });

    // Clear button event
    clearButton.addEventListener('click', function() {
        searchInput.value = '';
        filterFileTree('');
        searchInput.focus();
    });
}

// Button click handler for expanding/collapsing all files
function setAllSourceFilesCollapsed(collapsed) {
    document.querySelectorAll('.source-file').forEach(file => {
        if ((collapsed && file.classList.contains('expanded')) ||
            (!collapsed && !file.classList.contains('expanded'))) {
            file.querySelector('.source-file-header').click();
        }
    });
}

// Button click handler for expanding/collapsing empty files
function setEmptySourceFilesCollapsed(collapsed) {
    document.querySelectorAll('.source-file').forEach(file => {
        if (parseInt(file.dataset.linesActive) <= 0) {
            if ((collapsed && file.classList.contains('expanded')) ||
                (!collapsed && !file.classList.contains('expanded'))) {
                file.querySelector('.source-file-header').click();
            }
        }
    });
}    </script>
</body>
</html>